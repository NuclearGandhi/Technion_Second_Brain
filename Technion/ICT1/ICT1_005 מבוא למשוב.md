---
aliases:
  - בקרת משוב
  - משוב יחידה
---
# מבוא (תמים) למשוב

## משוב יחידה
יהי $y$ אות הניתן למדידה. נביט בבקר הבא:
![[Screenshot_20241208_114038_Samsung Notes.jpg|bookhue|450]]

בסכמה זו האות המבוקר $u$ נוצר כתוצאה מה-*חוסר התאמה* בין $y$ ואות הייחוס $r$. חוסר התאמה זה מסומן ב-$e$. למבנה בקר זה אנו קוראים **משוב יחידה**, והוא השיטת בקרת משוב הכי בסיסית.
מהתרשים לעיל נסיק כי:
$$\begin{gathered}
e=r-y \\[1ex]
e=r-PCe \\[1ex]
e=(1+PC)^{-1}r
\end{gathered}$$
מאחר וגם $u=Ce$ ו-$y=Pu$, נוכל לרשום גם:
$$u=C(1+PC)^{-1}r\qquad \text{and}\qquad y=PC(1+PC)^{-1}r$$
לכל אחד מהתהליכים הבאים ניתן שמות:
$$\begin{aligned}
 & r\to u: &  & \dfrac{C(s)}{1+P(s)C(s)}:=T_{c}(s) \\[1ex]
 & r\to y: &  & \dfrac{P(s)C(s)}{1+P(s)C(s)}:=T(s)=P(s)T_{c}(s) \\[1ex]
 & r\to e: &  & \dfrac{1}{1+P(s)C(s)}:=S(s)=1-T(s)
\end{aligned}$$
ל-$T_{c}(s)$ אנו קוראים **רגישות הבקר (control sensitivity)**, ל-$T(s)$ קוראים ה**רגישות המשלימה (complementary sensitivity)**, ול-$S(s)$ קוראים ה**רגישות (sensitivity)**.
נניח מעתה ואילך ש-$P(s)$ ו-$C(s)$ הם proper. נאמר שהמחוג **מוגדר היטב** אם $1+P(\infty)C(\infty)\neq 0$.

ניתן לחשוב
- על $T_{c}$ כמקביל ל-$C_{\text{ol}}$ מבקרה בחוג פתוח.
- על $T$ כמקביל ל-$T_{yr}=PC_{\text{ol}}$ מבקרה בחוג פתוח.

## בקר סטטי בהגבר גבוה
נשים לב שאם נבחר $C(s)=k_{p}$ עבור הגבר מסוים $k_{p}$:
![[Screenshot_20241208_115816_Samsung Notes.jpg|bookhue|500]]
אז:
$$T_{c}(s)=\dfrac{k_{p}}{1+k_{p}P(s)}=\dfrac{1}{1/k_{p}+P(s)}$$
נשים לב שאם $k_{p}\to \infty$, אז $T_{c} \to P^{-1}$, שזה כמעט זהה ל- $C_{\text{ol}}=P^{-1}$ מבקרה בחוג פתוח. יצרנו פה היפוך תהליך בבקרה בחוג סגור, רק שהפעם, המבקר $C(s)$ שלנו לא תלוי ב-$P(s)$.

## השפעת הפרעות
>[!TODO] TODO: להשלים



## כנופיית הארבעה
>[!TODO] TODO: להשלים



# תרגילים
## תרגיל 1
תהליך עם הפונקציית תמסורת:
$$P(s)=\dfrac{1}{s(s+1)(s+2)}$$
![[{39EBD566-CE14-4379-857C-A9A17162962C}.png|bookhue|500]]
מבוקר ע"י משוב יחידה עם בקרים סטטיים (פרופורציונליים) מהצורה $C(s)=k_{p}$.

### סעיף א'
מצאו את ארבעת הפונקציות תמסורת של מערכת זו. מהו הפולינום האופייני? תחת אלו הגברים המערכת במחוג סגור היא יציבה פנימית?

**פתרון**:
מהגדרת $C(s)$, כבר נוכל לומר ש:
$$u(t)=k_{p}e(t)$$
נחשב כל אחד מארבעת פונקציות התמסורת:
$$\begin{aligned}
 & T(s)=\dfrac{C(s)P(s)}{1+C(s)P(s)}=\dfrac{k_{p}}{s^{3}+3s^{2}+2s+k_{p}} \\[1ex]
 & S(s)=\dfrac{1}{1+C(s)P(s)}=\dfrac{s^{3}+3s^{2}+2s}{s^{3}+3s^{2}+2s+k_{p}} \\[1ex]
 & T_{c}(s)=\dfrac{C(s)}{1+C(s)P(s)}=\dfrac{k_{p}s^{3}+3k_{p}s^{2}+2k_{p}s}{s^{3}+3s^{2}+2s+k_{p}} \\[1ex]
 & T_{d}(s)=\dfrac{P(s)}{1+C(s)P(s)}=\dfrac{1}{s^{3}+3s^{2}+2s+k_{p}}
\end{aligned}$$
כדי לבדוק את היציבות אנו צריכים להביט במכנה. נזכור מ[[LSY1_007 Laplace Transform#Routh Table|טבלת רות]] שיש דרך מהירה לבדוק Hurwitz עבור פולינום ממעלה שלישית, ונסיק כי כדי שהמכנה יהיה Hurwitz, צריך להתקיים:
$$0<k_{p}<6$$

### סעיף ב'
יהי $k_{p}\in \{ 1,4,7 \}$. שרטטו את התגובות של כל מערכת בחוג סגור למדרגת יחידה. הסבירו את השוני בין התגובות לערכים שונים של $k_{p}$.

![[{05746E9E-815E-4B32-BE3F-F630F2BD13AB}.png|bookhue]]
>תגובות מדרגה של מערכת בחוג סגור.



## תרגיל 2
הביטו במערכת הבאה:

![[{2DA2A161-F78E-435A-AC6B-9660CBF5B0B9}.png|bookhue|250]]
>מטוטלת הפוכה על עגלה.

המטוטלת ההפוכה כוללת מסה $m$ על מוט חסר מסה באורך $l$ שמותקן על עגלה במסה $M$. כוח חיצוני $u$ פועל על העגלה. משוואות התנועה של מערכת זו הם:
$$\begin{gather}
(M+m)\ddot{z}(t)+ml\ddot{\theta}(t)\cos\theta(t)-ml\dot{\theta}^{2}(t)\sin\theta(t)=u(t)\tag{1a} \\[1ex]
\ddot{z}(t)\cos\theta(t)+l\ddot{\theta}(t)-g\sin\theta(t)\tag{1b}
\end{gather}$$
כאשר $\theta$ הוא הזווית של המטוטלת ו-$z$ הוא המיקום העגלה. הפרמטרים הם $m=\pu{5kg},\,M=\pu{10kg},\,l=\pu{1m}$ ותאוצת הכבידה $g=\pu{9.8m.s^{-2}}$.

### סעיף א'
בצעו לינאריזציה על המערכת ואת הפונקציית תמסורת שלה עם $u$ כקלט ותאוצת העגלה $y=\ddot{z}$ כפלט.

**פתרון**:
>[!TODO] TODO: לסדר

נשים לב שיש לנו 2 משתנים $\theta,z$ ודרגת הנגזרת הכי גבוה היא $z$. מבחינת משתני מצב יש לנו ארבעה שנסמנם:
$$\mathbf{x}(t)=\begin{pmatrix}
{x}_{1}(t) \\
{x}_{2}(t) \\
{x}_{3}(t) \\
{x}_{4}(t)
\end{pmatrix}=\begin{pmatrix}
z(t) \\
\theta(t) \\
\dot{z}(t) \\
\dot{\theta}(t)
\end{pmatrix}$$
לכן משוואות המצב שלנו בצורה מטריצית:
$$\underbrace{ \begin{pmatrix}
1 & 0 & 0 & 0 \\
0 & 1 & 0 & 0 \\
0 & 0 & M+m & m\ell \cos {x}_{2} \\
0 & 0 & \cos {x}_{2} & \ell
\end{pmatrix} }_{ \mathbf{E} }\dot{\mathbf{x}}=\underbrace{ \begin{pmatrix}
{x}_{3} \\
{x}_{4} \\
m\ell {{x}_{4}}^{2}\sin {x}_{2}+u \\
g\sin {x}_{2}
\end{pmatrix} }_{ \boldsymbol{\phi} }$$
אנו רוצים להעביר הכל לצד ימין, כך שנוכל לרשום את המשוואה באופן:
$$\dot{\mathbf{x}}=\mathbf{f}(\mathbf{x},u)$$
כדי לעשות זאת אנו צריכים לחשב:
$$\mathbf{f}(\mathbf{x},u)=\mathbf{E}^{-1}\boldsymbol{\phi}$$
במקרה שלנו, זה לא כזה נורא, אם נזכור ש-$\mathbf{E}$ הוא מטריצת בלוקים, ולכן הדטרמיננטה שלה היא פשוט הבלוק הימני התחתון, שהוא לא אפס, ולכן $\mathbf{E}$ הפיך ובכלל מותר לנו לרשום $\mathbf{E}^{-1}\mathbf{\boldsymbol{\phi}}$.

נתחיל מלמצוא נקודת שיווי משקל:
$$\begin{pmatrix}
{x}_{3} \\
{x}_{4} \\
m\ell {{x}_{4}}^{2}\sin {x}_{2}+u \\
g\sin {x}_{2}
\end{pmatrix}=0$$
נסיק כי:
$$\begin{aligned}
 & {x}_{3}=0 \\
 & {x}_{4}=0 \\
 & u=0 \\
 & {x}_{2}=\pm n\pi,\qquad n\in \mathbb{Z}
\end{aligned}$$
עבור מצב בו המטוטלת למעלה, נבחר ${x}_{2}=0$.
נשים לב גם שאין לנו תנאי על ${x}_{1}$, כך שזה לא משנה איפה המטוטלת נמצאת על הציר. נבחר ${x}_{1}={z}_{0}$ קבוע כלשהו. לכן נקודת שיווי המשקל שלנו:
$$\mathbf{x}_{\text{eq}}=\begin{pmatrix}
{z}_{0} \\
0 \\
0 \\
0
\end{pmatrix},\, \qquad u_{\text{eq}}=0$$

נמצא את היעקוביאנים, ונשים לב שזה לא כל כך פשוט:
$$\mathbf{A}=\dfrac{ \partial \mathbf{f} }{ \partial \mathbf{x} } \bigg|_{\text{eq}}^{} =\dfrac{ \partial \mathbf{E}^{-1} }{ \partial \mathbf{x} }\cdot \phi+ \mathbf{E}^{-1}\cdot\dfrac{ \partial \boldsymbol{\phi} }{ \partial \mathbf{x} } \bigg|_{\text{eq}}^{}  $$
נוכיח כעת שיש איזשהו טריק עם הגזירה של מטריצה הופכית. אנו יודעים ש:
$$\mathbf{I}=\mathbf{E}^{-1}\mathbf{E}$$
נגזור:
$$\begin{gathered}
0=\dfrac{ \partial \mathbf{E}^{-1} }{ \partial \mathbf{x} }\mathbf{E}+\mathbf{E}^{-1} \dfrac{ \partial \mathbf{E} }{ \partial \mathbf{x} }   \\[1ex]
\dfrac{ \partial \mathbf{E}^{-1} }{ \partial \mathbf{x} } =-\mathbf{E}^{-1}\cdot \dfrac{ \partial \mathbf{E} }{ \partial \mathbf{x} }\cdot \mathbf{E}^{-1} 
\end{gathered}$$
נציב את זה כעת ב-$\mathbf{A}$:
$$\mathbf{A}=\mathbf{E}^{-1}\left( \dfrac{ \partial \boldsymbol{\phi} }{ \partial \mathbf{x} } -\dfrac{ \partial \mathbf{E} }{ \partial \mathbf{x} } \cdot \cancel{ \mathbf{E}^{-1}\cdot\boldsymbol{\phi}  }\right)\bigg|_{\text{eq}}^{} $$
כאשר האיבר הימני מתבטל כי הוא שווה ל-$\mathbf{f}$, אבל $\mathbf{f}$ ב-$\text{eq}$ זה פשוט $0$ (זה ההגדרה של נקודת שיווי משקל.

נחשב את $\dfrac{ \partial \boldsymbol{\phi} }{ \partial \mathbf{x} }$:
$$\dfrac{ \partial \boldsymbol{\phi} }{ \partial \mathbf{x}}\bigg|_{\text{eq}}^{} =\begin{pmatrix}
0 & 0 & 1 & 0 \\
0 & 0 & 0 & 1 \\
0 & 0 & 0 & 0 \\
0 & g & 0 & 0
\end{pmatrix} $$
נמצא את הפונקציית תמסורת:
$$\dfrac{\mathbf{X}(s)}{U(s)}=\begin{pmatrix}
(\ell s^{2}-g)/s^{2} \\
-1 \\
(\ell s^{2}-g)/s \\
-s
\end{pmatrix}\cdot \dfrac{1}{M\ell s^{2}-(M+m)g}$$
ולכן ספציפית עבור $y$:
$$\dfrac{Y(s)}{U(s)}=\underbrace{ s^{2}\cdot {x}_{1}(s) }_{ \ddot{z} }=\dfrac{\ell s^{2}-g}{M\ell s^{2}-(M+m)g}$$
נציב נתונים ונקבל:
$$\dfrac{Y(s)}{U(s)}=\dfrac{0.1(s^{2}-9.8)}{s^{2}-14.7}$$
נסמנו כהתהליך שלנו:
$$\boxed {
P(s)=\dfrac{0.1(s^{2}-9.8)}{s^{2}-14.7}
 }$$

### סעיף ב'
המערכת נשלטת במשוב יחידה סטנדרטי. האם הוא ניתן לבקרה (כלומר, להתייצב) ע"י הבקר:
$$C(s)=\dfrac{10(s^{2}-14.7)}{s^{2}+4s+11.8}$$
וודאו את היציבות גם ע"י הפונקציות תמסורת של $T(s),S(s),T_{d}(s)$ ו-$T_{c}(s)$, וגם ע"י הפולינום האופייני של המערכת.

**פתרון**:
נשים לב שיש לנו צמצום לא יציב עם התהליך שיצא לנו בסעיף הקודם. נראה איך זה ישפיע על כנופיית הארבעה:
$$\begin{aligned}
 & T(s)=\dfrac{s^{2}-9.8}{2(s+1)^{2}} \\[1ex]
 & S(s)=\dfrac{s^{2}+4s+11.8}{2(s+1)^{2}} \\[1ex]
 & T_{c}(s)=\dfrac{5(s^{2}-14.7)}{(s+1)^{2}} \\[1ex]
 & T_{d}(s)=\dots =\dfrac{0.1(s^{2}-9.8)(s^{2}+4s+11.8)}{(s^{2}-14.7)(2s^{2}+4s+2)}
\end{aligned}$$
קיבלנו ש-$T_{d}(s)$ יש קוטב ב-RHP, $s=\sqrt{ 14.7 }$, מה שהופך את המערכת שלנו ללא יציבה פנימית. כל הפרעה, משב של רוח קטן, יפיל את המטוטלת שלנו.


### סעיף ג'
נתחו את התגובות מדרגה של המערכת $r \to y$ תחת הבקר לעיל ללא הפרעות, אם הכבידה היא למעשה:
$$g=\pu{9.80665m.s^{-2}}$$

**פתרון**:
אין לי כוח לרשום את זה. מפירוק לשברים חלקיים, נקבל שהגודל של הב

>[!TODO] TODO: להשלים