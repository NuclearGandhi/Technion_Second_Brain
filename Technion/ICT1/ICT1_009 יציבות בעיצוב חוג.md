---
aliases:
  - עיקרון הארגומנט של קושי
  - return difference
  - עקום נייקוויסט
  - קונטור נייקוויסט
  - קריטריון נייקוויסט
---
# קריטריון נייקוויסט

כדי לפשט את הדרישות שלנו על החוג הסגור, נחליף את
![[{4897FC32-BD60-4C73-95BB-39D835FCEAAF}.png|bookhue|450]]
ב:
![[{F6774616-6501-4D13-8338-BECD370542F6}.png|bookhue|300]]
בעיצוב החוג הסגור אנו רוצים:
- [[#אזור מעבר ותדירות מעבר|תדירות מעבר]] ${\omega}_{c}$ *מתאימה*. גבוה מספיק כך שנקבל תגובות מספיק מהירות ושנוכל לעקוב אחר טווח רחב של אותות ייחוס, אבל לא גבוה מדי כדי להימנע מהגברת רעשי מדידה ומאמצי הגברה משמעותיים.
- הגבר גבוה ($\lvert L(j\omega)\gg 1 \rvert$) בתדרים נמוכים $(\omega\ll{\omega}_{c})$.
- הגבר נמוך ($\lvert L(j\omega) \rvert\ll 1$) בתדרים גבוהים ($\omega\gg{\omega}_{c}$).
- הרחקת $L(j\omega)$ מהנקודה $-1+j 0$ באזור המעבר.
- **יציבות יציבות יציבות**.

כדי לקבל את התנאי האחרון, היציבות, אנו יכולים להיעזר בפולינום האופייני של המערכת, או בעזרת [[ICT1_006 שיטת מקום גאומטרי של שורשים#מבוא|שיטת המג"ש]], אבל אף אחד מהם לא עושה זאת במובנים של תגובת תדירות של $L$, שזה מה שעיצוב חוג צריך - הם עושים זאת בעזרת הפולינום האופייני. לכן, נפתח שיטה למציאת יציבות של חוג במובנים של $L$.

## עיקרון הארגומנט של קושי
תהי פונקציה מרוכבת $f(s)$. לכל $s \in \mathbb{C}$ מהמקור שלה, גם $f(s)\in \mathbb{C}$. אנו אומרים ש-$s$ *מועתקת* ע"י $f$ ממישור $s$ למישור $f(s)$.
![[{D48EFE0C-6DBA-4390-8E7D-023CFE688BC8}.png|bookhue]]
>העתקה $f(s)=\dfrac{0.273(-s+0.2)}{(s+0.6)(s+1)(s+1.3)}$ של מספר נקודות. [[ICT1_000 00340040 מבוא לבקרה#ביבליוגרפיה|(Leonid Mirkin’s Homepage, n.d.)]].

אם נבצע את ההעתקה לרצף של נקודות $s$, למשל עבור עקומה ${\Gamma}_{s}$ הנמצאת במישור $s$, ההעתק שלה גם יהיה עקומה ${\Gamma}_{f}$ במישור $f(s)$:

![[{D78E0F55-8850-4E12-9640-0853B8F06E0E}.png|bookhue]]
>העתקה $f(s)=\dfrac{0.273(-s+0.2)}{(s+0.6)(s+1)(s+1.3)}$ של עקומה סגורה פשוטה. [[ICT1_000 00340040 מבוא לבקרה#ביבליוגרפיה|(Leonid Mirkin’s Homepage, n.d.)]].

כמו בחדו"א, נאמר שעקומה היא [[CAL2_012 אינטגרלים קוויים ומשפט גרין#עקומה פשוטה|פשוטה]] אם היא לא חותכת את עצמה, ונאמר שהיא [[CAL2_012 אינטגרלים קוויים ומשפט גרין#עקומה סגורה|סגורה]] אם היא מתחילה ומסתיימת באותה הנקודה. מבין העקומות לעיל, ${\Gamma}_{s}$ פשוטה וסגורה, בעוד ${\Gamma}_{f}$ סגורה אבל לא פשוטה.


>[!theorem] משפט: 
> תהי ${\Gamma}_{s}$ עקומה פשוטה וסגורה, $f(s)$ **מרומורפית (meromorphic)** (כמו גזירה למקוטעין לפונקציות מרוכבות) *בתוך* ו-*על* ${\Gamma}_{s}$, ${Z}_{f}$ הוא מספר האפסים של $f(s)$ בתוך ${\Gamma}_{s}$, ו-${P}_{f}$ הוא מספר הקטבים של $f(s)$ בתוך ${Z}_{s}$. אזי:
> אם ${\Gamma}_{s}$ לא עובר דרך האפסים או הקטבים של $f(s)$, אז ${\Gamma}_{f}$ מקיף את הראשית ${Z}_{f}-{P}_{f}$ פעמים עם כיוון השעון כאשר $s$ מתקדמת ב-${\Gamma}_{s}$ עם כיוון השעון.

למשל, עבור
$$f(s)=\dfrac{0.273(-s+0.2)}{(s+0.6)(s+1)(s+1.3)}$$
עם ${P}_{f}=3$ קטבים ו- ${Z}_{f}=0$ בתוך ${\Gamma}_{s}$:

![[{CAB076A0-1312-4DC0-9F01-FE362B00A5E7}.png|bookhue]]
>העתקה $f(s)$ על עקומה ${\Gamma}_{s}$. [[ICT1_000 00340040 מבוא לבקרה#ביבליוגרפיה|(Leonid Mirkin’s Homepage, n.d.)]].

לכן ${\Gamma}_{f}$ מקיף את הראשית $-3$ פעמים עם כיוון השעון (כך שהוא מקיף אותו $3$ פעמים נגד כיוון השעון).

נוכל גם להפעיל את אותו העיקרון אם ישנה הזזה בקבוע. למשל, אם $f(s)=\alpha+g(s)$ ל-$\alpha \in \mathbb{R}$ כלשהו, אז:
![[{9AFD4971-F91C-4899-8952-5F8795BF5A7D}.png|bookhue]]
>העתקה $f(s)$ ו-$g(s)$. [[ICT1_000 00340040 מבוא לבקרה#ביבליוגרפיה|(Leonid Mirkin’s Homepage, n.d.)]].


## פונקציית ה-return difference
יהי
$$L(s):=P(s)C(s)=\dfrac{{N}_{L}(s)}{{D}_{L}(s)}$$
שראינו בפרק קודם - פונקציית התמסורת של החוג. נניח כי אין צמצומים לא יציבים בין $P(s)$ ו-$C(s)$. נביט כעת בפונקציית תמסורת הבאה:
$$1+L(s)=\dfrac{{N}_{L}(s)+{D}_{L}(s)}{{D}_{L}(s)}=\dfrac{\mathcal{X}_{\text{cl}}(s)}{{D}_{P}(s){D}_{C}(s)}$$
הנקראת **return difference**. מהקשר לעיל ניתן לראות ש:
- קטבים לא יציבים של $1+L(s)$ הם קטבים לא יציבים של החוג הפתוח.
- אפסים לא יציבים של $1+L(s)$ הם קטבים לא יציבים של החוג הסגור.

נביט במערכת הבא:
![[{5C1F74A8-4209-4D26-8749-EA5AE731CDC5}.png|bookhue|250]]
נניח כי $L(s)$ הוא proper ואין לו קטבים בציר $j\omega$ (נוריד את ההנחה האחרונה בהמשך).

בהמשך הפרק אנו הולכים לבצע את השלבים הבאים:
1. נגדיר עקומה סגורה פשוטה ${\Gamma}_{s}$ המכילה את כל הקטבים הלא יציבים - כל הקטבים ב-RHP הפתוח ($\mathbb{C}_{0}:= \{ s \in \mathbb{C}\mid \mathrm{Re}\,s>0 \}$).
2. נמצא את ההעתקה ${\Gamma}_{1+L}$ של ${\Gamma}_{s}$ ע"י ה-return difference ($1+L(s)$).
3. נספור את מספר הסיבובים $\nu$ עם כיוון השעון של הראשית ע"י העקום ${\Gamma}_{1+L}$.

לפי [[#עיקרון הארגומנט של קושי]]:
$$\nu=\pi^{+}_{\text{cl}}-\pi^{+}_{\text{ol}}$$
כאשר:
- המספר ${\pi}_{\text{cl}}^{+}$ הוא מספר הקטבים של החוג הסגור ב- $\mathbb{C}_{0}$.
- המספר $\pi^{+}_{\text{ol}}$ הוא מספר הקטבים של החוג הפתוח (של $L(s)$) ב-$\mathbb{C}_{0}$.

האם נעביר אגפים במשוואה לעיל:
$$\pi^{+}_{\text{cl}}=\nu+\pi^{+}_{\text{ol}}$$
אנחנו רוצים ש- $\pi^{+}_{\text{cl}}=0$, כי אז לא יהיו קטבים לא יציבים בחוג הסגור. לכן, על כל קוטב לא יציב בחוג הפתוח, אנחנו רוצים סיבוב *נגד כיוון השעון* שיפצה עליו (שוב, $\nu$ נחשב חיובי עבור הקפות *עם כיוון השעון*).

ראינו שהקשר בין המישור $1+L(s)$ והמישור $L(s)$ הוא רק *הזזה* אופקית ב-$1$:
![[{F44974B5-7C90-4056-B1F9-8979771222C8}.png|bookhue|600]]
>הזזה אופקית במישור.

לכן, מספר ההקפות סביב הראשית של ${\Gamma}_{1+L}$ הוא מספר ההקפות של ${\Gamma}_{L}$ סביב $\color{red} -1+j 0$. מעתה נעבוד עם מישור $L(s)$, ונתייחס לנקודה $-1+j 0$ כ**נקודה הקריטית**.

## עקום נייקוויסט
העקום
$${\Gamma}_{s}={\Gamma}_{s,1} \cup{\Gamma}_{s,2}\cup{\Gamma}_{s,3}$$
כאשר
$$\begin{aligned}
 & {\Gamma}_{s,1}=j\omega, &  & \omega:0\to R, \\[1ex]
 & {\Gamma}_{s,2}=Re^{j\theta}, &  & \theta: \dfrac{\pi}{2}\to -\dfrac{\pi}{2} \\[1ex]
 & {\Gamma}_{s,3}=j\omega, &  & \omega:-R\to 0
\end{aligned}$$
נקרא **קונטור נייקוויסט**, כאשר $R\to \infty$. הוא כולל את כל הקטבים ב-RHP הפתוח של פונקציות תמסורת עם מספר סופי של קטבים.
![[{3317953C-38E9-40D8-A8B9-74874F5A6553}.png|bookhue|250]]
>קונטור נייקוויסט.

כעת נרצה לדעת מהי ההעתקה של קונטור נייקוויסט לפי פונקציה כלשהי $L(s)$.
- עבור ${\Gamma}_{s,1}$:
	במקרה זה $s=j\omega,\,\omega\geq 0$, כך שהתמונה שלו היא $L(j\omega)$, כך שלמעשה ${\Gamma}_{L,1}$ הוא *הגרף הפולארי של תגובת התדירות של $L$*.
- עבור ${\Gamma}_{s,2}$:
	מאחר ו-$L(s)$ הוא proper:
	$$L(Re^{j\theta})=\dfrac{{b}_{n}R^{n}e^{j\theta n}+\dots +{b}_{1}Re^{j\theta}+{b}_{0}}{R^{n}e^{j\theta n}+\dots +{a}_{1}Re^{j\theta}+{a}_{0}}$$
	ניתן להראות שעבור $R \to \infty$, נקבל $L(Re^{j\theta})={b}_{n}$ לכל $\theta$, כך ש-${\Gamma}_{L,2}$ הוא נקודה יחידה ${b}_{n}$. מאחר ונקודה זו כבר שייכת ל-${L}_{L,1}$, נוכל להתעלם מ-${\Gamma}_{L,2}$.
- עבור ${\Gamma}_{s,3}$:
	זהו מקרה זהה ל-${\Gamma}_{s,1}$, רק עם $-j\omega$ במקום $j\omega$, ולכן ${\Gamma}_{L,3}$ הוא הצמוד (מראה) של הגרף הפולארי ${\Gamma}_{L,1}$ סביב הציר הממשי.

האיחוד של ${\Gamma}_{L,1}$ ו-${\Gamma}_{L,3}$, שהוא הגרף של $L(j\omega)$ בקואורדינטות פולאריות כאשר $\omega$ רץ מ-$-\infty$ ל-$\infty$, נקרא **עקום נייקוויסט** של $L(j\omega)$.
נוכל לבנות את עקום זה בשני שלבים:
1. נבנה את הגרף הפולארי של $L(j\omega)$ (שהוא הגרף של $L(j\omega)$ בקואורדינטות פולאריות כאשר $\omega$ רץ מ-$0$ עד $\infty$).
2. נוסיף את המראה של הגרף הפולארי סביב הציר הממשי.

## קריטריון יציבות נייקוויסט
>[!theorem] משפט: 
> המערכת בחוג סגור יציבה אמ"ם עקום נייקוויסט של $L(j\omega)$:
> - לא חותכת את הנקודה הקריטית $-1+j 0$.
> - סובבת סביב הנקודה הקריטית ${\pi}_{\text{ol}}^{+}$ פעמים נגד כיוון השעון כאשר $\omega$ גדל מ-$-\infty$ ל-$\infty$, ו-${\pi}_{\text{ol}}^{+}$ הוא מספר הקטבים של $L(s)$ ב-$\mathbb{C}_{0}$.


**עיקרון ראשון**:
אם עקומת נייקוויסט של $L(j\omega)$ לא חותכת את הנקודה הקריטית, אז מספר הקטבים הלא יציבים בחוג הסגור הוא:
$$\pi^{+}_{\text{cl}}=\pi^{+}_{\text{ol}}+\nu$$
כאשר $\nu$ הוא מספר ההקפות עם כיוון השעון של הנקודה הקריטית $-1+j 0$ ע"י עקום נייקוויסט.

**עיקרון שני**:
עם עקומת נייקוויסט של $L(j\omega)$ חותכת את הנקודה הקריטית בתדירות מסוימת $\omega={\omega}_{0}$, אז ל-$\mathcal{X}_{\text{cl}}$ יש לפחות שורש אחד ב- $s=j{\omega}_{0}$.

**עיקרון שלישי**:
אם $L$ יציב, אז המערכת בחוג סגור יציבה אמ"ם הגרף הפולארי של $L(j\omega)$ לא חותך ולא מקיף את הנקודה הקריטית כאשר $\omega$ רץ מ-$-\infty$ ל-$\infty$.

>[!example] דוגמה: 
>יהי $L(s)=\dfrac{1.2}{s+1}$. העקום נייקוויסט שלו הוא:
>![[{40C05E59-A980-40EC-BE20-ACCE4E901739}.png|bookhue|400]]
>קיבלנו ש-$L$ הוא יציב (כי ${\pi}_{\text{ol}}^{+}=0$), וגם העקום נייקוויסט לא סובב את הנקודה הקריטית. לכן, המערכת בחוג סגור *יציבה*.


>[!example] דוגמה: 
> יהי $L(s)=\dfrac{(3s+8)(9s^{2}+3s+19)}{125(s+1)^{3}}$. העקום נייקוויסט שלו הוא:
> ![[{21092540-5BAC-488E-B12F-C83122C90A37}.png|bookhue|400]]
>קיבלנו ש-$L$ הוא יציב (כי ${\pi}_{\text{ol}}^{+}=0$), וגם העקום נייקוויסט לא סובב את הנקודה הקריטית. לכן, המערכת בחוג סגור *יציבה*.


>[!example] דוגמה: 
> יהי $L(s)=\dfrac{2}{(s-1)(0.125s+1)^{3}}$. העקום נייקוויסט שלו:
> ![[{88656A8C-E1AF-4B91-950B-EFB2C0AB8BC0}.png|bookhue|400]]
> קיבלנו ש-$L$ לא יציב עם קוטב אחד לא יציב (אז $\pi^{+}_{\text{ol}}=1$). בנוסף, העקום נייקוויסט סובב את הנקודה הקריטית פעם אחת נגד כיוון השעון. לכן, המערכת בחוג סגור *יציבה*.
> 

מומלץ לראות את הדוגמאות הנוספות במצגת.

## עקום נייקוויסט כללי

עד כה הנחנו של-$L(s)$ אין קטבים בראשית, ואז אנו יכולים להשתמש ב[[#עיקרון הארגומנט של קושי]] עם קונטור נייקוויסט שהגדרנו. אם יש קוטב בראשית, עלינו להגדיר את קונטור זה באופן קצת שונה:

$${\Gamma}_{s}={\Gamma}_{s,0}\cup{\Gamma}_{s,1} \cup{\Gamma}_{s,2}\cup{\Gamma}_{s,3}\cup{\Gamma}_{s,4}$$
כאשר
$$\begin{aligned}
 & {\Gamma}_{s,0}=\epsilon e^{j\theta}, &  & \theta:0\to \dfrac{\pi}{2} \\[1ex]
 & {\Gamma}_{s,1}=j\omega, &  & \omega:0\to R, \\[1ex]
 & {\Gamma}_{s,2}=Re^{j\theta}, &  & \theta: \dfrac{\pi}{2}\to -\dfrac{\pi}{2} \\[1ex]
 & {\Gamma}_{s,3}=j\omega, &  & \omega:-R\to 0 \\[1ex]
 & {\Gamma}_{s,4}=\epsilon e^{j\theta}, &  & \theta:-\dfrac{\pi}{2}\to 0
\end{aligned}$$
עם $R\to \infty$ וגם $\epsilon \to 0$. קונטור זה עדיין כולל את כלל הקטבים ב-RHP הפתוח של פונקציות תמסורת עם מספר סופי של קטבים.

ההעתקה של ${\Gamma}_{s,1} \cup{\Gamma}_{s,2}\cup{\Gamma}_{s,3}$ לא משתנה, אז עלינו רק לסיים את התמונה עם:
- עבור ${\Gamma}_{s,0}$:
	יהי $L(s)=\dfrac{1}{s^{n}}\tilde{L}(s)$, כאשר $n\in \mathbb{N}$ ו-$\tilde{L}(0)\neq 0$ הוא סופי - כלומר, $n$ הוא מספר האינטגרטורים. במקרה זה:
	$$L(\epsilon e^{j\theta})=\dfrac{1}{\epsilon^{n}e^{j\theta n}}\tilde{L}(\epsilon e^{j\theta})\xrightarrow[\epsilon \to  0]{} \dfrac{\tilde{L}(0)}{\epsilon^{n}}e^{-j\theta n}$$
	כך ש-${\Gamma}_{L,0}$ הוא עקום ברדיוס $\infty$, המתחיל חיובי (אם $\tilde{L}(0)>0$) או שלילי (אם $\tilde{L}(0)<0$) בציר הממשי, וממשיך ל-$n\pi /2$ עם כיוון השעון, עד שהוא חותך את התחלת ${\Gamma}_{L,1}$.
- עבור ${\Gamma}_{s,4}$:
	מאחר ו-$L(s)$ יש מקדמים ממשיים, $L(-j\omega)=\overline{L(j\omega)}$, ולכן ${\Gamma}_{L,4}$ הוא מראה של ${\Gamma}_{L,0}$ סביב הציר הממשי.

>[!notes] הערה: 
 >האיחוד ${\Gamma}_{L,4}\cup {L}_{L,0}$ הוא קשת המחברת את הקצוות של ${\Gamma}_{L,3}(\omega \to 0^{-})$ וההתחלה של ${\Gamma}_{L,1}(\omega \to 0^{+})$ דרך הזווית $\pi n$ עם כיוון השעון.
 
 כעת, כיוון שהקונטור נייקוויסט המתוקן לא כולל את הקטבים של $L(s)$ בראשית, לא נספור את קטבים אלו ב-${\pi}_{\text{ol}}^{+}$. נוכל לעשות זאת כי ל-$\mathcal{X}_{\text{cl}}(s)$ אין שורשים ב-$s=0$, ולכן כל הקטבים הלא יציבים של החוג הסגור נמצאים בתוך קונטור נייקוויסט המתוקן אם $\epsilon$ קטן מספיק.

>[!example] דוגמה:
> יהי $L(s)=\dfrac{1}{s}$. העקום נייקוויסט שלו:
> ![[{5A506857-26F9-4AE3-AEA5-8636FF2610A9}.png|bookhue|250]]
> קיבלנו ש-$L$ "יציב" (${\pi}_{\text{ol}}^{+}=0$), והעקום נייקוויסט שלו לא מקיף את הנקודה הקריטית. לכן, המערכת בחוג סגור *יציבה*.


>[!example] דוגמה: 
> יהי $L(s)=\dfrac{1}{s^{5}}$. העקום נייקוויסט שלו הוא:
> ![[{1B99D8C6-6632-457A-9441-3CE8B49E693B}.png|bookhue|350]]
> 
> קיבלנו ש-$L$ "יציב" (${\pi}_{\text{ol}}^{+}=0$), והעקום נייקוויסט שלו סובב את הנקודה הקריטית פעמיים *עם* כיוון השעון. לכן, המערכת בחוג סגור *לא יציבה* (${\pi}_{\text{cl}}^{+}=2$).

מומלץ לראות את הדוגמאות הנוספות במצגת.

# פישוטים על הקריטריון ליציבות
ספירת ההקפות נגד כיוון השעון בגרף מסועף יכולה להיות בעייתית:
![[{9212814D-B494-48A2-A782-2BC060CC5053}.png|bookhue|500]]
>עקומת נייקוויסט מעצבנת לניתוח. יש במקרה זה $-4$ סיבובים נגד כיוון השעון.

אבל, בעזרת טופולוגיה, ישנה שיטה לפישוט מציאת מספר ההקפות.

תהי קרן $(-\infty,-1]$ במישור ה-$L(j\omega)$:
![[{CEFDE5E3-2FD2-4DD0-884D-F0F20618F29B}.png|bookhue|500]]

נאמר שישנו **חיתוך** כאשר העקומה של $L(j\omega)$ חותכת את הקרן. נאמר שה**חיתוך חיובי** אם כיוון $L(j\omega)$ הוא כלפי מטה, ונאמר שה**חיתוך שלילי** אם כיוון $L(j\omega)$ הוא כלפי מעלה.

>[!theorem] למה:
>מספר ההקפות נגד כיוון השעון סביב הנקודה הקריטית ע"י עקום נייקוויסט של $L(j\omega)$ שווה למספר החיתוכים עם הקרן $(-\infty,-1]$ ע"י *עקום נייקוויסט* של $L(j\omega)$.
![[{913A0343-A853-4A12-93EA-0AFB59F17656}.png|bookhue|500]]
>חיתוכים של *עקום נייקוויסט* עם הקרן $(-\infty,-1]$.


>[!theorem] למה:
>מספר ההקפות נגד כיוון השעון סביב הנקודה הקריטית ע"י עקום נייקוויסט של $L(j\omega)$ שווה לפי-$2$ מספר החיתוכים עם הקרן $(-\infty,-1]$ ע"י *הגרף הפולארי* של $L(j\omega)$.
![[{3B9E95F5-FFB2-4B8A-81D0-94B107C80F77}.png|bookhue|500]]
>חיתוכים של *הגרף הפולארי* עם הקרן $(-\infty,-1]$.

עלינו להיזהר ממקרים בהם הגרף הפולארי מתחיל או מסתיים על הקרן. במצבים אלו, נחשיב את נקודות אלו כ-"חצי חיתוך".

# ניתוח חוגים
בהנחה ויש לנו מערכת מהצורה:
![[{0CEF34F9-F68F-4BBD-A401-938D094C86F5}.png|bookhue|350]]

כאשר $\tilde{L}(s)$ הוא פונקציית תמסורת proper ו-$k$ הוא פרמטר שאנו רוצים לבחור. אנו רוצים למצוא את כל ה-$k$ עבורו $L$ הוא יציב - מאוד דומה לרעיון ה[[ICT1_006 שיטת מקום גאומטרי של שורשים|מג"ש]].

נוכל לרשום את פונקציית התמסורת return difference כ:
$$1+L(s)=1+k \tilde{L}(s)=k\left( \dfrac{1}{k}+\tilde{L}(s) \right)$$
מאחר וההכפלה ב-$k$ לא משפיעה על הקטבים או האפסים של פונקציית תמסורת זו, נוכל לנתח את היציבות שלה ע"י ההעתקה של קונטור נייקוויסט ע"י $\dfrac{1}{k}+\tilde{L}(s)$. במילים אחרות זה אומר שאנו צריכים לנתח את העקומת נייקוויסט של $\tilde{L}(j\omega)$ עם הנקודה הקריטית $-\dfrac{1}{k}+j 0$. 

>[!example] דוגמה: 
> יהי $\tilde{L}(s)=\dfrac{2}{(s-1)(0.125s+1)^{3}}$. העקום נייקוויסט שלו הוא:
> ![[{835C7430-A3FB-4154-BC61-66572BFF5693}.png|bookhue|450]]
> במקרה זה, ${\pi}_{\text{ol}}^{+}=1$, וישנם ארבעה קטעים שונים של $k$ עבורם נקבל יציבויות שונות:
> - עבור $-\dfrac{1}{k}<-2$, אין הקפות, ולכן ${\pi}_{\text{cl}}^{+}=1$.
> - עבור $-2<-\dfrac{1}{k}<-0.39$, יש הקפה אחת נגד כיוון השעון, ולכן $\pi^{+}_{\text{cl}}=0$.
> - עבור $-0.39<-\dfrac{1}{k}<0$, יש הקפה אחת עם כיוון השעון, ולכן ${\pi}_{\text{cl}}^{+}=2$.
> - עבור $-\dfrac{1}{k}>0$, אין הקפות, ולכן $\pi^{+}_{\text{cl}}=1$.

# תרגילים
## תרגיל 1
התהליך
$$P(s)=\dfrac{12}{(s+2)^{2}(s+2.5)}$$
מבוקר בחוג סגור (משוב יחידה) ע"י בקר פרופורציונלי $C(s)={k}_{p}$. מצא ${k}_{p}$-ים המייצבים את המערכת ע"י קריטריון היציבות של נייקוויסט.

**פתרון**:
החוג הפתוח:
$$L(s)={k}_{p}P(s)$$
נעבוד במה שנקרא **שיטת הנקודה הצפה**. נגדיר:
$$\tilde{L}(s):=P(s)=\dfrac{12}{(s+2)^{2}(s+2.5)}$$
נבדוק איפה $\tilde{L}(s)$ חותך את הציר הממשי, כלומר איפה הפאזה שלו $\pi n$.
$$\tilde{L}(j\omega)=\dfrac{12}{(j\omega+2)^{2}(j\omega+2.5)}$$
לכן הפאזה:
$$\arg \tilde{L}(j\omega)=-\arg 12-2\arg(j\omega+2)-\arg(j\omega+2.5)$$
נשווה ל-$\pi n$, ולאחר זהויות מכוערות נקבל:
$$\begin{gathered}
\dfrac{2\omega(\omega ^{2}-14)}{13\omega ^{2}-20}=0 \\[1ex]
{\omega}_{1}=0,\qquad {\omega}_{2}=\sqrt{ 14 }
\end{gathered}$$
אנו מקבלים גם ${\omega}_{3}=-\sqrt{ 14 }$, אבל הוא קיים בתמונת מראה, ולכן נתעלם ממנו כרגע.
נשים לב שכאשר $\omega={\omega}_{1}=0$, מתקיים $P(0)=\dfrac{12}{4\cdot 2.5}=1.2$. כאשר $\omega={\omega}_{2}=\sqrt{ 14 }$, נקבל $P(j \sqrt{ 14 })\approx -0.148$.

ממיקומים אלו, אנו יודעים לשרטט את [[#עקום נייקוויסט]]:
![[{F6A27B4F-FA52-4F80-ABC1-1E4235AAF2E2}.png|bookhue]]
>עקומות נייקוויסט עם מיקומי נקודות קריטיות שונים.

מאחר ו-$\pi^{+}_{\text{ol}}=0$, נרצה לדעת מתי $\nu=0$. נשים לב ש:
- אם $-\dfrac{1}{{k}_{p}}<-0.148$, אז $\nu=0$, ולכן החוג הסגור יציב.
- אם $-0.148<-\dfrac{1}{{k}_{p}}<0$, אז $\nu=2$, ולכן החוג הסגור לא יציב.
- אם $0<-\dfrac{1}{{k}_{p}}<1.2$, אז $\nu=1$, ולכן החוג הסגור לא יציב.
- אם $1.2<-\dfrac{1}{{k}_{p}}$, אז $\nu=0$ ולכן החוג הסגור יציב.

אם נסתכל במג"ש:
![[{3ACD34F8-8A9E-46F0-B69C-649EA2D96985}.png|bookhue]]
>דיאגרמות מג"ש לבעיה.

## תרגיל 2
התהליך
$$P(s)=\dfrac{s^{2}+4s/3+4}{6s(s^{2}+s/2+1)}$$
מבוקר בחוג סגור (משוב יחידה) ע"י בקר פרופורציוני $C(s)={k}_{p}$, ל-${k}_{p}>0$. מצאו את מספר הקטבים של החוג הסגור ב-RHP כפונקציה של ${k}_{p}$ בעזרת קריטריון יציבות נייקוויסט.

**פתרון**:
נעשה את אותו התהליך. נתחיל מהפאזה:
$$\tilde{L}(s):=P(s)=\dfrac{s^{2}+4s/3+4}{6s(s^{2}+s/2+1)}$$
נסיק $\pi^{+}_{\text{ol}}=0$ כי האינטגרטור [[#עקום נייקוויסט כללי|לא נחשב]].
החיתוכים עם הציר הממשי:
$$\begin{gathered}
\arg \tilde{L}(j\omega)=\pi n \\[1ex]
\arg\left( -\omega ^{2}+j \dfrac{4\omega}{3}+4 \right)-\arg(j6\omega)-\arg\left( -\omega ^{2}+j \dfrac{\omega}{2}+1 \right)=\pi n
\end{gathered}$$
לאחר עוד כמה פיתוחים מעצבנים נקבל ש:
$${\omega}_{1}=\dfrac{2}{\sqrt{ 3 }},\qquad {\omega}_{2}=\sqrt{ 3 }$$
החיתוכים מתרחשים ב:
$$\tilde{L}(j{\omega}_{1})=-2/3,\qquad \tilde{L}(j{\omega}_{2})=-1/9$$
כדי לצייר את הגרף הפולארי של $\tilde{L}(s)$ כבר לא מספיק לדעת רק את נקודות חיתוך אלה - הפונקציה כבר לא מונוטונית. נצטרך קודם לבנות את הבודה שלה:
![[{7A5B7A04-795D-4BAE-A86C-E854A3B93660}.png|bookhue|500]]
>גרף בודה של $\tilde{L}(s)$.

מגרף בודה זה אנו יודעים לשרטט את הגרף הפולארי:

![[{BF668DCD-B70F-4ECB-AED2-08ADE5039184}.png|bookhue|500]]
>הגרף הפולארי של $\tilde{L}(j\omega)$ (ללא המראה שלו). ההשלמה שלו ברבע מעגל היא כתוצאה מהאינטגרטור.

נמצא את מספר הסיבובים לפי [[#פישוטים על הקריטריון ליציבות|חיתוכים עם הקרן]]:
![[{C77B1A60-AD1D-4346-B980-7F85D19E93CE}.png|bookhue|300]]
>ערכי $-\dfrac{1}{{k}_{p}}$ שונים.

מאחר ו-$\pi^{+}_{\text{ol}}=0$, נרצה לדעת מתי $\nu=0$. נשים לב ש:
- אם $-\dfrac{1}{{k}_{p}}<-\dfrac{2}{3}$, אז $\nu=0$, ולכן החוג הסגור יציב.
- אם $-\dfrac{2}{3}<-\dfrac{1}{{k}_{p}}<-\dfrac{1}{9}$, אז $\nu=2$, ולכן החוג הסגור לא יציב.
- אם $-\dfrac{1}{9}<-\dfrac{1}{{k}_{p}}<0$, אז $\nu=0$, ולכן החוג הסגור יציב.

