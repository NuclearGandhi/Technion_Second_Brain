---
aliases:
---
# מבוא
כדי להבין מערכות בקרה מסובכות, עלינו לתאר אותם בעזרת מודלים מתמטיים. מאחר ורוב המערכות הן **דינמיות** בטבען, המודלים המתמטיים שיתארו אותם הם [[DEQ1_001 מבוא#משוואה דיפרנציאלית|משוואות דיפרנציאליות]]. אם משוואות אלו ניתנות ל[[LSY1_005 Linearization#Local Linearization Around an Equilibrium Point|לינאריזציה]], אז נוכל להשתמש ב[[LSY1_007 Laplace Transform#The Laplace Transform|התמרת לפלס]] כדי לפשט את דרך פתרון הבעיה.
בתאכלס, הסיבוכיות של המערכות ואי הוודאות שלנו לגבי הפרמטרים הרלוונטיים כופה עלינו לבצע הנחות לגבי אופן פעולת המערכת.

# משוואות דיפרנציאליות של מערכות פיזיקליות
נתחיל מדוגמה של מערכת קפיץ-מסה פיתולית עם מומנט פיתול $T_{a}(t)$ המופעל עליו:


![[Screenshot_20241105_131809_Drive.jpg|bookhue|300]]
>מערכת מסה-קפיץ פיתולית (torsional spring-mass system).

נניח שהקפיץ חסר מסה ואנו רוצים למדוד את הפיתול $T_{s}(t)$  המועבר למסה $m$. מאחר והקפיץ חסר מסה, סכום המומנטי פיתול הפעולים על הקפיץ חייב להתאפס (שקול כוחות):
$$
T_{a}(t)-T_{s}(t)=0
$$
מה שאומר ש- $T_{s}(t)=T_{a}(t)$. אנו רואים מיד שהמומנט פיתול החיצוני $T_{a}(t)$ המופעל בסוף הקפיץ מועבר *דרך* הקפיץ פיתול. לכן, אנו קוראים לפיתול **משתנה-דרך (through-variable)**. באותו אופן, הפרש המהירות הזוויתית הוא:
$$
\omega(t)=\omega_{s}(t)-\omega_{a}(t)
$$
כלומר, הפרש המהירות הזוויתית נמדד *לרוחב* הקפיץ פיתול, ולכן אנו קוראים להפרש זה **משתנה רוחבי (across-variable)**. באותו אופן אנו יכולים להכליל למקרים פיזיקליים שונים כדי לקבל את הטבלה הבאה:
![[Screenshot_20241105_133653_Drive 2.jpg|bookhue]]
>סיכום של משתני דרך ומשתני רוחב עבור מערכות פיזיקליות.

# פונקציית התמרה של מערכות לינאריות
ה[[LSY1_004 Linear State-Space Equation#Transfer Function|פונקציית התמרה]] של מערכת לינארת מוגרת כהיחס של ההתמרת לפלס של הפלט להתמרת לפלס של הקלט, כאשר אנו מניחים תנאי התחלה אפסיים.
פונקציית התמרה מוגדרת רק עבור מערכת לינארית וקבועה (קבועה בזמן). במערכת שהיא לא קבועה בזמן (time-varying system) לא נוכל להשתמש בהתמרת לפלס שלה. בנוסף, הפונקציית התמרה היא תיאור של התנהגות הקלט-פלט של מערכת. כלומר, הפונקציית התמרה לא מתארת את המבנה הפנימי של המערכת והתנהגותה.

>[!example] דוגמה: פונקציית התמרה של מערכת שתי מסות
>נביט במערכת המכנית הבאה:
>![[{2ECAEA73-B47A-43BE-8756-4C64A887BC0E}.png|bookhue|400]]
>מחוק שני על כל אחד מהמסות, לאחר התמרת לפלס, נקבל את המשוואה:
>$$
> \begin{gathered}
>{M}_{1}s{V}_{1}(s)+({b}_{1}+{b}_{2}){V}_{1}(s)-{b}_{1}{V}_{2}(s)=R(s)
>\end{gathered}
> $$
>ועל המסה השנייה:
>$$
> {M}_{2}s{V}_{2}(s)+{b}_{1}{V}_{2}((s)-{V}_{1}(s))+k \dfrac{{V}_{2}(s)}{s}=0
> $$
>נסדר את שתי משוואות אלו כדי לקבל את מערכת המשוואות:
>$$
> \begin{gathered}
>({M}_{1}s+({b}_{1}+{b}_{2})){V}_{1}(s)+(-{b}_{1}){V}_{2}(s)=R(s) \\
>(-{b}_{1}){V}_{1}(s)+\left( {M}_{2}s+{b}_{1}+\dfrac{k}{s} \right){V}_{2}(s)=0
>\end{gathered}
> $$
>או, באופן מטריצי:
>$$
> \begin{pmatrix}
>{M}_{1}s+{b}_{1}+{b}_{2} & -{b}_{1} \\
>-{b}_{1} & {M}_{2}s+{b}_{1}+\dfrac{k}{s}
>\end{pmatrix}\begin{pmatrix}
>{V}_{1}(s) \\
>{V}_{2}(s)
>\end{pmatrix}=\begin{pmatrix}
>R(s) \\
>0
>\end{pmatrix}
> $$
>בהנחה והפלט שאנו מעוניים בו הוא המהירות של ${M}_{1}$, אנו נפתור עבור ${V}_{1}(s)$:
>$$
> {V}_{1}=\dfrac{({M}_{2}s+{b}_{1}+k/s)R(s)}{({M}_{1}s+{b}_{1}+{b}_{2})({M}_{2}s+{b}_{1}+k/s)-{{b}_{1}}^{2}}
> $$
>כך הפונקציית התמרה של המערכת המכנית היא:
>$$
> \begin{aligned}
>G(s) =\dfrac{{V}_{1}(s)}{R(s)} & =\dfrac{{M}_{2}s+{b}_{1}+k/s}{({M}_{1}s+{b}_{1}+{b}_{2})({M}_{2}s+{b}_{1}+k/s)-{{b}_{1}}^{2}} \\[1ex]
 >& =\dfrac{{M}_{2}s^{2}+{b}_{1}s+k}{({M}_{1}s+{b}_{1}+{b}_{2})({M}_{2}s^{2}+{{b}_{1}}^{2}+k)-{{b}_{1}}^{2}s}
>\end{aligned}
> $$


>[!example] דוגמה: פונקציית התמרה של מנוע DC
>מנוע DC הוא *מפעיל* שמספק אנרגיה לעומס מסוים, כפי שמוצג באיור הבא:
> ![[Screenshot_20241105_135444_Drive 1.jpg|bookhue]]
>המנוע DC ממיר אנרגיה חשמלית של זרם ישר (DC) לארגיה מכנית סיבובית. חלק גדול מהפיתול שנוצר ברוטור (הזרוע של המנוע) משומש כדי ליצור עומס חיצוני.
>הפונקציית התמרה של מנוע DC שנבנה מזניח כל מני אפקטים ממעלה שנייה כמו מפלי מתח לרוחב המברשות, כך שאנו מניחים שהוא לינארי. בעזרת חוקים מכניים וחשמליים, אנו יכולים לבנות את הדיאגרמת בלוקים הבאה:
> ![[Screenshot_20241105_141550_Drive.jpg|bookhue]]
>ולקבל כי הפונקציית התמרה היא:
>$$
> G(s)=\dfrac{\theta(s)}{V_{f}(s)}=\dfrac{K_{m}}{s(Js+b)(L_{f}s+R_{f})}
> $$

>[!TODO] TODO: להשלים
# דיאגרמות בלוקים
המערכות הדינמיות שמרכיבות מערכת בקרה משובית לרוב מתוארות מתמטית ע"י מספר משוואות דיפרנציאליות. ראינו ב[[LSY1_000 034032 Linear Systems E|מערכות לינאריות]] שאת המשוואות הדיפרנציאליות נוכל להפוך לפונקציית התמרה המקשרת בין הקלט והפלט של כל תת-מערכת. את קשר פעולה ותגובה זה נהוג להציג בדיאגרמת בלוקים. באיור הבא מוצג דיאגרמת בלוק של מנוע DC:
![[Screenshot_20241105_134424_Drive.jpg|bookhue|400]]
>דיאגרמת בלוק של מנוע DC.

כדי לתאר מערכת עם מספר משתנים בבקרה, נידרש להשתמש בחיבור בלוקים. למשל, המערכת באיור הבא כוללת שני משתני קלט ושני משתני פלט:
![[{85301975-0205-4A21-BCA0-65E354F915FE}.png|bookhue|400]]
>ייצוג בלוק של מערכת עם שני משתני קלט ושני משתני פלט.

בעזרת הפונקציות התמרה נוכל לרשום את המשוואות המתארות את מערכת זו:
$$
\begin{aligned}
 & {Y}_{1}(s)={G}_{11}(s){R}_{1}(s)+{G}_{12}(s){R}_{2}(s) \\[1ex]
 & {Y}_{2}(s)={G}_{21}(s){R}_{1}(s)+{G}_{22}(s){R}_{2}(s)
\end{aligned}
$$
כאשר ${G}_{ij}(s)$ הוא הפונקציית התמרה שמקשר בין הפלט ה-$i$ לקלט ה-$j$. הדיאגרמת בלוקים המייצגת את מערכת משוואות זו מוצגת באיור הבא:
![[{791B74D5-7B99-4985-AA3A-58BE0AFFEB47}.png|bookhue|400]]
>דיאגרמת בלוקים של מערכת עם שני משתני קלט ושני משתני פלט.

במקרה הכללי, עבור קלטים $J$ ופלטים $I$, נוכל לרשום את מערכת המשוואות באופן מטריצי:
$$
\begin{pmatrix}
{Y}_{1}(s) \\
{Y}_{2}(s) \\
\vdots  \\
Y_{I}(s)
\end{pmatrix}=\begin{pmatrix}
{G}_{11}(s) & \cdots &  G_{1J}(s) \\
{G}_{21}(s) & \cdots & G_{2J}(s) \\
\vdots  &  & \vdots  \\
G_{I1}(s) & \cdots  & G_{IJ}(s)
\end{pmatrix}\begin{pmatrix}
{R}_{1}(s) \\
{R}_{2}(s) \\
\vdots  \\
R_{J}(s)
\end{pmatrix}
$$
או:
$$
\mathbf{Y}(s)=\mathbf{G}(s)\mathbf{R}(s)
$$
הדיאגרמת בלוקים של מערכת לרוב ניתנת לפישוט - הרי במערכות לינאריות פעולת ההכפלה היא קומוטטיבית. להלן טבלה המסכמת את אופן הפישוט:
![[{E804A4DA-B673-4215-99FF-AF73D79F2862}.png|bookhue]]
>התמרת דיאגרמות בלוקים.


# תרגילים
## תרגיל 1

האיור הבא מתאר מערכת לשליטה בזווית $\theta_{a}(t)$ של אנטנה.


![[Screenshot_20241120_103000_Obsidian.jpg|bookhue|400]]
>אנטנה מופעלת ע"י מנוע DC.

האנטנה, בעלת מומנט אינרציה $J_{a}$ ושמאוזנת ביחס לציר האנכי, מסובבת ע"י המנוע DC עם קבוע מומנט $K_{m}$, קבוע החזר emf $K_{b}$, התנגדות זרוע $R$, עם אינרציה והשראת זרוע זניחה.
>[!TODO] TODO: להשלים

### סעיף א'
מצאו את משוואות התנועה של המערכת.

**פתרון**:
ללא הזנחת השראות, משוואת מנוע DC:
$$
v(t)-v_{b}(t)=R\cdot i(t)+L\cdot \dot{i}(t)
$$
מתח ההחזר emf הוא:
$$
v_{b}=K_{b}\cdot\dot{\theta}_{m}
$$
בהזנחת ההשראות $L$ נקבל:
$$
i(t)=\dfrac{v(t)-v_{b}}{R}=\dfrac{v(t)-K_{b}\cdot\dot{\theta}_{m}(t)}{R}
$$
נכפול בקבוע מומנט $K_{m}$:
$$
\boxed {
i(t)\cdot K_{m}=\tau_{m}(t)=\dfrac{K_{m}}{R}(v(t)-K_{b}\cdot\dot{\theta}_{m}(t))
 }
$$

### סעיף ב'
בנו דיאגרמת-בלוקים של המערכת וחשבו את פונקציית התמסורת של המערכת $v\to\theta_{a}$.

**פתרון**:

>[!TODO] TODO: להוסיף שרטוט

>[!notes] הערה: 
 >אנו מפרידים את $K_{m}$ ו-$R$ לשני בלוקים, כי כמהנדסים אנו רוצים גם לדעת מהו הזרם במערכת. בפירוק לשני בלוקים, אנו יכולים גם להוציא עוד קו ביניהם כדי להציג את מדידת הזרם $i(t)$.
 
 נבצע דג"ח על הגלגל שיניים (גג"ש) הגדול. מופעיל עליו המומנט שנובע מהמנוע $\tau_{m}\cdot n$ (תמסורת) ומומנט שנובע מקפיץ הפיתול. האינרציה של הגג"ש זניחה ולכן סכום מומנטים הוא $0$:
 $$\begin{gathered}
0=n\tau_{m}(t)+\tau_{\text{rod}}(t) \\[1ex]
0=\tau_{m}(t)+k\left( \theta_{a}(t)-\dfrac{1}{n}\theta_{m}(t) \right)
\end{gathered}$$
כאשר ב-$\text{rod}$ הכוונה למוט שמוביל בין הקפיץ פיתול לאנטנה.
נמשיך כדי לקבל ביטוי ל-$\theta_{m}$:
$$
\theta_{m}(t)=\dfrac{n^{2}}{k}\cdot \tau_{m}(t)+n\cdot\theta_{a}(t)
$$
>[!TODO] TODO: להוסיף דיאגרמת בלוקים

נמשיך עם משוואת מומנטים על העומס (אנטנה):
$$\begin{aligned}
J_{a}\cdot\ddot{\theta}_{a} & =\tau_{\text{rod}}-c_{a}\dot{\theta}_{a} \\[1ex]
 & =-k\left( \theta_{a}-\dfrac{1}{n}\theta_{m} \right)-c_{a}\dot{\theta}_{a}
\end{aligned}$$
נשים לב שבדיאגרמה, $\tau_{m}$ ו-$\theta_{a}$ חופשיים, ונרצה להשתמש בהם. מתוך נוחות לא נרצה להשתמש ב-$\theta_{m}$ כי אם נוציא ממנו עוד ענף זה יסבך את הגרף, ודי יהרוס את הרעיון המפשט בדיאגרמת בלוקים.
לכן, נבטא את $\theta_{m}$ עם הקשר הקודם:
$$\begin{gathered}
J_{a}\cdot \ddot{\theta}_{a}+c_{a}\dot{\theta}_{a}=-k\left( \theta_{a}-\dfrac{1}{n}\cdot\left[ \dfrac{n^{2}}{k}\tau_{m}+n\theta_{a} \right] \right) \\[1ex]
J_{a}\ddot{\theta}_{a}+c_{a}\dot{\theta}_{a}=n\tau_{m}
\end{gathered}$$
נבצע התמרת לפלס:
$$\begin{gathered}
J_{a}\Theta_{a}s^{2}+c_{a}\Theta_{a}s+=nT_{m}(s) \\[1ex]
\Theta_{a}(s)=\dfrac{n}{s(J_{a}s+c_{a})}T_{m}(s)
\end{gathered}$$

יש לנו כאן פונקציית תמסורת $\tau_{m}\to\theta_{a}$.

>[!TODO] TODO: להשלים


## תרגיל 2
הביטו במערכת ריחוף מגנטית הבאה:
![[Screenshot_20241120_113516_Samsung Notes.jpg|bookhue|300]]
>מערכת ריחוף מגנטית

זרם חשמלי $i$ זורם דרך סליל בעל התנגדות $R$ והשראות $L$, כך שהוא יוצר שדה מגנטי שמושך כדור ברזל בעל מסה $m$. המטרה היא לשלוט על מיקום הכדור $y$ ע"י מתח כניסה $v$. הכוח האלקטרומגנטי שנפעל ע"י השדה המגנטי על הכדור הוא:
$$
f_{\text{em}}=\alpha \dfrac{i^{2}(t)}{y^{2}(t)}
$$
כאשר $\alpha>0$ הוא קבוע.

### סעיף א'
רשמו את משוואות התנועה של המערכת והמימוש מצב שלו.

**פתרון**:
הדינמיקה של המעגל $RL$ היא:
$$
\dfrac{\mathrm{d}}{\mathrm{d}t}(Li(t))+Ri(t)=v(t)
$$
ממאזן כוחות על הכדור:
$$
m\ddot{y}(t)=-\alpha \dfrac{i^{2}(t)}{y^{2}(t)}+mg
$$
הדינמיקה של כלל המערכת היא שילוב של שתי המד"רים לעיל. נשים לב שיש לנו שלושה משתני מצב במערכת - $y,\,\dot{y},\,i$. בנוסף, את הקלט הוא $v$. לכן נסמן:
$$
\mathbf{x}=\begin{pmatrix}
{x}_{1} \\
{x}_{2} \\
{x}_{3}
\end{pmatrix}=\begin{pmatrix}
y \\
\dot{y} \\
i
\end{pmatrix},\qquad u=v
$$
מהמד"רים אנו כעת יכולים לרשום את המשוואת מצב:
$$
\begin{aligned}
 & \dot{\mathbf{x}}(t)=\begin{pmatrix}
\dot{x}_{1}(t)\\
\dot{x}_{2}(t)\\
\dot{x}_{3}(t)
\end{pmatrix}=\begin{pmatrix}
{x}_{2}(t) \\
g-\dfrac{\alpha}{m}{{x}_{3}}^{2}(t)/{{x}_{1}}^{2}(t) \\
\dfrac{1}{L}u(t)-\dfrac{R}{L}{x}_{3}(t)
\end{pmatrix} &  & :=f(x,u) \\[1ex]
 & y(t)={x}_{1}(t) &  & :=h(x,u)
\end{aligned}
$$
שזהו מערכת מד"ר מסד"ר ראשון.

נבצע כעת [[LSY1_005 Linearization#Local Linearization Around an Equilibrium Point|לינאריזציה]]. נרצה למצוא את הנקודות שיווי משקל, כלומר נאפס את $f$:
$$
\begin{pmatrix}
{x}_{2} \\
g-\dfrac{\alpha}{m}{{x}_{3}}^{2}(t)/{{x}_{1}}^{2} \\
\dfrac{1}{L}u-\dfrac{R}{L}{x}_{3}
\end{pmatrix}=0
$$
נקבל ש:
$$\begin{aligned}
 & x_{\text{eq},1}=\sqrt{ \alpha /mg }\,x_{\text{eq},3} \\[1ex]
 & x_{\text{eq},2}=0 \\[1ex]
 & Rx_{\text{eq},3}=u_{\text{eq}}
\end{aligned}$$
לכן, עבור כל מיקום הכדור ${y}_{0}$, אז $x_{\text{eq},1}={y}_{0}$ ואז יש לנו פתרון יחיד לנקודת שיווי משקל:
$$
(\mathbf{x}_{\text{eq}},\, u_{\text{eq}})=\left[\begin{pmatrix}
{y}_{0} \\
0 \\
\sqrt{ mg/\alpha }\,{y}_{0}
\end{pmatrix},\, R\sqrt{ \dfrac{mg}{\alpha} }{y}_{0}\right]
$$
ולכן גם $y_{\text{eq}}={y}_{0}$.
נגדיר כעת משתנים חדשים:
$$
\begin{aligned}
 & \tilde{\mathbf{x}}=\mathbf{x}-\mathbf{x}_{\text{eq}} \\[1ex]
 & \tilde{u}=u-u_{\text{eq}} \\[1ex]
 & \tilde{y}=y-y_{\text{eq}}
\end{aligned}
$$
נגזור כעת הפונקציות במשוואת מצב כדי למצוא את המטריצות:
$$
\mathbf{A}=
$$

>[!TODO] TODO: להשלים