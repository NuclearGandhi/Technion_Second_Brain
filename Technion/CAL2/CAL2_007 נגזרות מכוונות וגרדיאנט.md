---
aliases: נגזרת מכוונת, גרדיאנט
---

>[!notes] הערות:
>כל הגדרה כאן ניתן בקלות להרחיב לפונקציה ב-$n$ משתנים.

# נגזרות מכוונות

ב[[CAL2_006 נגזרות של פונקציות בשני משתנים#נגזרות חלקיות|נגזרות חלקיות]] אנו מקבעים את אחד מהמשתנים $x$ או $y$, ומבצעים גזירה כמו במשתנה אחד. ניזכר כי ערך הנגזרת הוא השיפוע $m$ של המשיק לגרף שנוצר כאשר אנו מקבעים את אחד ממשתנים אילו. למשל עבור קיבוע $x$ ל-${x}_{0}$ אנו למעשה לוקחים את החתך של המשטח עם המישור $x={x}_{0}$ ומבצעים לו גזירה.

אבל מה אם אנו רוצים למצוא את השיפוע של הישר המשיק למשטח $z=f(x,y)$ לפי זווית/כיוון אחר? מה אם במקום חיתוך של המשטח עם $x={x}_{0}$ ניקח חיתוך של המשטח עם מישור בזווית כמו $x+y=0$?

מבחינה גאומטרית, זה ייראה כך עבור $z=f(x,y)$ וכיוון והמישור $y+x=0$ (הטלה של הישר $y+x=0$ על המשטח):

<iframe scrolling="no" title="Directional Derivatives" class="geo" src="https://www.geogebra.org/material/iframe/id/cdw3vvec/width/700/height/400/border/ffffff/sfsb/false/smb/false/stb/false/stbh/false/ai/false/asb/false/sri/false/rc/false/ld/false/sdz/true/pb/true/ctl/false" width="600px" height="400px" style="border:0px;"> </iframe>

מבחינה אלגברית, יותר קל לנו לנסח זאת בצורה של לקחת ישר על המישור $xy$ ולהטיל אותו על המשטח:


תהי פונקציה $z=f(x,y)$ ונקודה $({x}_{0},{y}_{0},f({x}_{0},y))$ עליה. ניקח [[CAL2_001 וקטורים#וקטור גאומטרי|וקטור יחידה]] $\hat{a}=({a}_{1},{a}_{2})$ העובר דרך הנקודה $({x}_{0},{y}_{0})$. הישר העובר דרך הנקודה הזו:
$$
\ell:\begin{cases}
x={x}_{0}+{a}_{1}t \\
y={y}_{0}+{a}_{2}t
\end{cases}
$$
![[Screenshot_20230509_101024_Chrome.jpg|book]]

ההטלה של ישר זה על הפונקציה היא [[CAL2_003 משטחים ריבועיים#עקומה|עקומה]]:
$$
\Gamma:\begin{cases}
x={x}_{0}+{a}_{1}t \\
y={y}_{0}+{a}_{2}t \\
z=f({x}_{0}+{a}_{1}t,{y}_{0}+{a}_{2}t)
\end{cases}
$$

### נגזרת מכוונת
>[!def] הגדרה:
>תהי הפונקציה $z=f(x,y)$ בתחום $D$ ונתונה $({x}_{0},{y}_{0})$ ב-$D$ עם וקטור *יחידה* $\hat{a}=({a}_{1},{a}_{2})$. אז **הנגזרת המכוונת** של $f$ בכיוון $\hat{a}$ בנקודה $({x}_{0},{y}_{0})$ נתונה ע"י:
>$$
> D_{\hat{a}}f({x}_{0},{y}_{0})=\lim_{ t \to 0 } \frac{f({x}_{0}+{a}_{1}t, {y}_{0}+{a}_{2}t)-f({x}_{0},{y}_{0})}{t}
> $$
>
>בהינתן והגבול קיים.
>

>[!notes] הערות:
>1. אם $\hat{a}=(1,0)$, אז זוהי פשוט הנגזרת החלקית $f'_{x}$. באותו אופן עבור $\hat{a}=(0,1)$.
>2. ישנה גרסת הגדרה יותר כללית לנגזרות מכוונת במקרה שרוצים להשתמש בוקטור שהוא לא וקטור יחידה:
>	$$
>	D_{\hat{a}}f({x}_{0},{y}_{0})=\lim_{ t \to 0 } \frac{f({x}_{0}+{a}_{1}t, {y}_{0}+{a}_{2}t)-f({x}_{0},{y}_{0})}{|\vec{a}|t}
>	$$


**תרגילים:**
1. נתונה הפונקציה:
	$$
	f(x,y)=\begin{cases}
	\frac{x^{3}-3xy^{2}}{x^{2}+y^{2}} & (x,y)\neq(0,0) \\
	0 & (x,y=(0,0)
	\end{cases}
	$$
	באלו כיוונים יש לפונקציה נגזרות מכוונות בראשית?
	**פתרון**:
	$$
	\hat{u}=({u}_{1},{u}_{2})\implies {u}_{1}^{2}+{u}_{2}^{2}=1
	$$
	$$
	\begin{aligned}
	\frac{ \partial f }{ \partial u } &=\lim_{ h \to 0 } \frac{f({u}_{1}h,{u}_{2}h)-f(0,0)}{h} \\
	&=\lim_{ h \to 0 } \frac{\frac{{u}_{1}^{3}h^{3}-3{u}_{1}h{u}_{2}^{2}h^{2}}{{u}_{1}sh^{2}+{u}_{2}^{2}h^{2}}}{h} \\
	&=\frac{{u}_{1}^{3}-3{u}_{1}{u}_{2}^{2}}{{u}_{1}^{2}+{u}_{2}^{2}} \\
	&={u}_{1}^{3}-3{u}_{1}{u}_{2}^{2}
	\end{aligned}
	$$
	תשובה זו מוגדרת לכל ${u}_{1},{u}_{2}$ ולכן קיימים נגזרות מכוונות בכל כיוון.

### דיפרנציאביליות גוררת קיום נגזרות מכוונות
>[!theorem] משפט:
>אם $z=f(x,y)$ פונקציה [[CAL2_006 נגזרות של פונקציות בשני משתנים#דיפרנציאביליות|דיפ']] בנקודה $({x}_{0},{y}_{0})$ אז ל-$f$ יש נגזרת מכוונת בכל כיוון $\hat{a}=({a}_{1},{a}_{2})$ ומתקיים:
>$$
> D_{\hat{a}}f({x}_{0},{y}_{0})=f'_{x}({x}_{0},{y}_{0})\cdot {a}_{1}+f'_{y}({x}_{0},{y}_{0})\cdot {a}_{2}
> $$

**הוכחה:**
הנגזרת המכוונת בכיוון $\vec{a}=({a}_{1},{a}_{2})$:
$$
D_{\hat{a}}f({x}_{0},{y}_{0})=\lim_{ t \to 0 } \frac{f({x}_{0}+{a}_{1}t, {y}_{0}+{a}_{2}t) -f({x}_{0},{y}_{0})}{t} \tag{1}
$$

נגדיר עקומה חדשה, כאשר $x={x}_{0}+{a}_{1}t,\, y={y}_{0}+{a}_{2}t$:
$$
\begin{aligned} \\
g(t)&=f(x,y)\\
&=f({x}_{0}+t, {y}_{0}+t)
\end{aligned}
$$

לפי [[CAL2_006 נגזרות של פונקציות בשני משתנים#כלל השרשרת ממשטח לעקומה|כלל השרשרת]], נוכל לכתוב כי:
$$
\begin{align}
g'(t)&=f'_{x}(x,y)({x}_{0}+t)'+f'_{y}(x,y)({y}_{0}+t)' \\
&=f'_{x}(x,y)\cdot {a}_{1}+f'_{y}(x,y)\cdot {a}_{2} \\
g'(0)&=f'_{x}({x}_{0},{y}_{0})\cdot {a}_{1}+f'_{y}({x}_{0},{y}_{0})\cdot {a}_{2} \tag{2}
\end{align}
$$

לפי הגדרה נוכל גם לרשום:
$$
g'(0)=\lim_{ t \to 0 } \frac{f({x}_{0}+{a}_{1}t, {y}_{0}+{a}_{2}t) -f({x}_{0},{y}_{0})}{t} \tag{3}
$$

מ-$(1),(2),(3)$ נסיק כי:
$$
D_{\hat{a}}f({x}_{0},{y}_{0})=g'(0)=f'_{x}({x}_{0},{y}_{0})\cdot {a}_{1}+f'_{y}({x}_{0},{y}_{0})\cdot {a}_{2}
$$

$\blacksquare$

האינטואציה מאחורי המשפט הזה תהיה יותר ברורה לאחר שנלמד על הגרדיאנט.

# גרדיאנט הפונקציה
במשתנה אחד, ערך הנגזרת בנקודה ${x}_{0}$ נותן את שיפוע המשיק לפונקציה בנקודה זו. דרך אחרת לחשוב על שיפוע המשיק, היא אם נדמיין בן אדם על גרף הפונקציה, ונשאל באיזה כיוון יהיה הכי קשה לעלות בנקודה ${x}_{0}$.

![[CAL2_007 נגזרות מכוונות וגרדיאנט 2023-05-15 17.35.44.excalidraw.svg]]

בפונקציה במשתנה אחד יש רק שני כיוונים - הכיוון השלילי של $x$ או הכיוון החיובי. אז אם השיפוע $m$ חיובי, יהיה לנו הכי קשה לטפס בכיוון החיובי של הפונקציה (הרי הפונקציה עולה). אם השיפוע שלילי, אז הפוקציה יורדת - הכי קשה לעלות בכיוון השלילי של הפונקציה.
מעבר לכיוון, השיפוע נותן לנו גם *כמה* קשה לעלות. ככל שהשיפוע יותר גדול, יותר קשה לטפס.

אז נסכם שהנגזרת של פונקציה במשתנה אחד נותנת לנו *גודל* *וכיוון* - כמו וקטור. אבל וקטור במימד אחד ניתן להציג כסקלר - $\vec{v}=(-1)=-1$, אז במשתנה אחד אין שום משמעות לסימון הנגזרת/שיפוע כוקטור.

בפונקציה בשני משתנים, אנחנו חייבים להתייחס לזה כוקטור:
### גרדיאנט
>[!def] הגדרה:
>תהי $z=f(x,y)$ פונקציה שה[[CAL2_006 נגזרות של פונקציות בשני משתנים#נגזרת חלקית|נגזרות חלקיות]] קיימות בנקודה $({x}_{0},{y}_{0})$. אזי הוקטור $\vec{\nabla }f({x}_{0},{y}_{0})$ נקרא ה**גרדיאנט** של $f$ בנקודה זו ונתון ע"י:
>$$
> \vec{\nabla}f({x}_{0},{y}_{0})=f'_{x}({x}_{0},{y}_{0})\hat{\mathbf{i}}+f'_{y}({x}_{0},{y}_{0})\hat{\mathbf{j}}=(f'_{x}({x}_{0},{y}_{0}),f'_{y}({x}_{0},{y}_{0}))
> $$

בפונקציה בשני משתנים הכוונה בגרדיאנט נשארה אותו הדבר כמו הנגזרת במשתנה אחד - קיבלנו גודל וכיוון המעידים לנו על כיוון העלייה התלולה ביותר ואת קושי העלייה.

<iframe scrolling="no" title="Gradient" class="geo" src="https://www.geogebra.org/material/iframe/id/mwme4qtr/width/700/height/400/border/ffffff/sfsb/true/smb/false/stb/false/stbh/false/ai/false/asb/false/sri/false/rc/false/ld/false/sdz/true/ctl/false" width="600px" height="400px" style="border:0px;"> </iframe>

>[!notes] הערות:
>1. הגרדיאנט מקבל שני משתנים, ונותן בחזרה *וקטור דו מימדי*.

נביט בחזרה בנגזרות מכוונות, ונשים לב כי ערך הנגזרת המכוונת בכיוון $\hat{a}$ נותן לנו את השיפוע של כיוון $\hat{a}$ על המשטח. מה אם במקרה, כיוון זה הוא הכיוון בעל השיפוע הכי גבוה? אזי כיוון זה הוא כיוון הגרדיאנט:
$$
\hat{a}=\frac{\vec{\nabla}f}{|\vec{\nabla}f|}
$$

ישנו קשר הדוק בין הנגזרת המכוונת לגרדיאנט. מ[[#דיפרנציאביליות גוררת קיום נגזרות מכוונות|המשפט]]  נסיק כי:
### מכפלה סקלרית של הגרדיאנט בכיוון הוא הנגזרת המכוונת
>[!theorem] משפט:
>תהי $z=f(x,y)$ דיפ' בנקודה $({x}_{0},{y}_{0})$, ווקטור יחידה $\hat{a}=({a}_{1},{a}_{2})$. אזי:
>$$
> D_{\hat{a}}f({x}_{0},{y}_{0})=\vec{\nabla}f({x}_{0},{y}_{0})\cdot  \hat{a}
> $$

### הקשר בין גרדיאנט לנגזרת מכוונת
>[!theorem] משפט:
>תהי $f$ דיפ' בנקודה $({x}_{0},{y}_{0})$.
>1. אם $\vec{\nabla}f({x}_{0},{y}_{0})=\vec{0}$ אז הנגזרת המכוונת $D_{\hat{a}}f({x}_{0},{y}_{0})=0$ לכל $\hat{a}$.
>2. אם $\vec{\nabla}f({x}_{0},{y}_{0})\neq \vec{0}$ אז ערך הנגזרת המכוונת המקסימלית תהיה בכיוון הגרדיאנט:
>	$$
>	\hat{a}=\frac{\vec{\nabla}f}{|\vec{\nabla}f|}
>	$$
>3. אם $\vec{\nabla}f({x}_{0},{y}_{0})\neq \vec{0}$ אז ערך הנגזרת המכוונת המינימלית תהיה נגד כיוון הגרדיאנט:
>	$$
>	\hat{a}=-\frac{\vec{\nabla}f}{|\vec{\nabla}f|}
>	$$
>	![[Pasted image 20230515192148.png|book]]
>	

דרך נוספת לראות את הקשר בין גרדיאנט ונגזרת מכוונת היא לפי האנימציה הבאה (לחצו על הכפתור בצד שמאל למטה):
<iframe scrolling="no" title="Gradient" class="geo" src="https://www.geogebra.org/material/iframe/id/ktqfw6br/width/700/height/400/border/ffffff/sfsb/true/smb/false/stb/false/stbh/false/ai/false/asb/false/sri/false/rc/false/ld/false/sdz/false/ctl/false" width="600px" height="400px" style="border:0px;"> </iframe>

נשים לב שהוקטור שמסתובב הוא לא הנגזרת המכוונת (הרי ערך הנגזרת הוא פשוט סקלר), אלא רק מציג את גודל ערך הנגזרת המכוונת.

**תרגילים:**
1. תהי $f(x,y)$ דיפ' ב-$(1,1)$. בנוסף, הנגזרת המכוונת של $f$ בנקודה זו בכיוון $\vec{a}=(3,2)$ היא $\sqrt{ 13 }$. כמו כן, מתקיים:
	$$
	f(x^{2},2x-1)=x^{3}
	$$
	לכל $x$. חשבו $\vec{\nabla} f(1,1)$.
	**פתרון**:
	הפונקציה $f$ דיפ' ולכן:
	$$
	\begin{gather}
	\frac{ \partial f }{ \partial a } =\vec{\nabla} f \cdot \hat{a}=\sqrt{ 13 } \\
	(f'_{x},f'_{y})\cdot\left( \frac{3,2}{\sqrt{ 13 }} \right)=\sqrt{ 13 } \\
	3f'_{x}+2f'_{y}=13 \tag{1}
	\end{gather}
	$$
	מותר לנו להשתמש בכלל השרשרת:
	$$
	f'_{x}2x+f'_{y}\cdot 2=3x^{2}
	$$
	נשים לב כי $x^{2}=1, \, 2x-1=1$, ולכן $x=1$. נסיק כי:
	$$
	\begin{gather} 2f'_{x}+2f'_{y}=3 \tag{2}
	\end{gather}
	$$
	מ-$(1),(2)$ נסיק כי:
	$$
	\vec{\nabla} f(1,1)=\left( 10,-\frac{16}{2} \right)
	$$

### קווי גובה וגרדיאנט
>[!theorem] משפט:
>תהי פונקציה $z=f(x,y)$ בעלת נגזרות חלקיות רציפות בסביבה של $({x}_{0},{y}_{0})$. אם $\vec{\nabla}f({x}_{0},{y}_{0})\neq 0$, אז $\vec{\nabla}f({x}_{0},{y}_{0})$ הוא נורמל ל[[CAL2_005 פונקציה בשני משתנים, טופולוגיה#קווי גובה|קו גובה]] של $f$ ב-$({x}_{0},{y}_{0})$.

![[Pasted image 20230516224455.png|book|400]]
>[!notes] הערות:
>1. כמו כל מושג כאן, ניתן להרחיב את משפט זה לפונקציה בשלושה משתנים ויותר. הגרדיאנט של פונקציה בשלושה משתנים היא נורמל למשטח רמה של הפונקציה (בנקודה מסוימת) - ולכן גם נורמל למישור המשיק בנקודה זו.

1. אתר סקי מתואר ע"י המשטח $z=f(x,y), \,f(x,y)=xy$.
	גולש עומד בנקודה $(x,y)=(-3,-1)$ ורוצה לגלוש בכיוון הירידה החזקה ביותר במרחב, מהו הכיוון?
	**פתרון**:
	הגולש יכל להחליט על כיוון של רכיבי $(x,y)$ בלבד של כיוון הגלישה, ולכן, מכאן שרוצה בכיוון הירידה החזקה ביותר, הוא יבחר:
	$$
	-\vec{\nabla} f=(-y,-x)=(1,3)
	$$
	מצאנו את כיוון הגלישה על המישור: $(1,3)$. נמצא את כיוון הגלישה במרחב:
	$$
	(1,3,\alpha)
	$$
	המשטח שלנו:
	$$
	\begin{gather}
	z=xy \\
	xy-z=0
	\end{gather}
	$$
	הנורמל של המישור המשיק (ראה [[#קווי גובה וגרדיאנט]], הערה 1):
	$$
	N=\vec{\nabla} F=(y,x,-1)
	$$
	 בנקודה שלנו:
	$$
	\vec{N}=\vec{\nabla} F=(-1,-3,-1)
	$$
	ברגע הגלישה, הגולש נמצא על המישור המשיק למשטח באותה נקודה.
	לכן המכפלה הסקלרית שלהן תתאפס:
	$$
	0=(1,3,\alpha)\cdot(-1,-3,-1)=-1-9-\alpha\implies \alpha=-10
	$$
	נקבל כי כיוון הגלישה הוא:
	$$
	(1,3,-10)
	$$
1. טמפרטורה נתונה ע"י הפונקציה:
	$$
	f(x,y,z)=\frac{16}{1+x+y^{2}+z}
	$$
	נמלה נמצאת על המשטח שמשוואתו נתונה ע"י:
	$$
	x^{2}+y+z^{2}=3
	$$
	בנקודה $(1,1,1)$
	לאיזה כיוון תפנה הנמלה אם ברצונה להעלות את הטמפרטורה מהר ככל האפשר כך שהיא נשארת על המשטח?
	**פתרון**:
	$$
	\begin{gather}
	f=16(1+x+y^{2}+z)^{-1} \\
	\Downarrow \\
	\begin{aligned}
	&f'_{x}=-16(1+x+y^{2}+z)^{-2} \\
	&f'_{y}=-16(1+x+y^{2}+z)^{-2}\cdot 2y \\
	&f'_{z}=-16(1+x+y^{2}+z)^{-2}
	\end{aligned}
	\end{gather}
	$$
	ולכן: $\vec{\nabla} f=(-1,-2,-1)$
	הנורמל למישור המשיק למשטח הוא:
	$$
	N=\vec{\nabla} F=(2x,1,2z)
	$$
	ולכן הנורמל בנקודה הוא $(2,1,2)$.
	נסמן את כיוון ההליכה ב-$\vec{v}=(a,b,c)$. וקטור זה על המישור המשיק למשטח ולכן:
	$$
	\begin{gather}
	(a,b,c)\cdot \vec{N}=0 \\
	(a,b,c)\cdot(2,1,2)=0 \\
	2a+b+2c=0 \tag{1}
	\end{gather}
	$$
	ניעזר בחיבור וקטורים:
	![[CAL2_007 נגזרות מכוונות וגרדיאנט 2023-05-23 21.59.17.excalidraw.svg]]
	נסיק כי:
	$$
	\begin{gather}
	\vec{v}=\vec{\nabla}f-\alpha \vec{N} \\
	(a,b,c)=(-1,-2,-1)-\alpha(2,1,2)\tag{2} 
	\end{gather}
	$$
	מ-$(1),(2)$ נסיק כי:
	$$
	\vec{v}=\left( \frac{1}{3},-\frac{4}{3},\frac{1}{3} \right)
	$$
3. הטמפרטורה בחלל נתונה ע"י הנוסחא:
	$$
	T(x,y,z)=xyz
	$$
	חללית נוסעת לאורך מסלול שנוסחתו היא:
	$$
	x(t)=t, y(t)=t^{2}, z(t)=\sqrt{ t }
	$$
	- מהי מהירות החללית בנקודה $(1,1,1)$?
		**פתרון**:
		מהירות היא נגזרת של הדרך. לכן:
		$$
		\vec{v}(t)=(x',y',z')=\left( 1,2t,\frac{1}{2\sqrt{ t }} \right)
		$$
		כדי לקבל את הנקודה $(1,1,1)$ צריכים להציב $t=1$, ולכן:
		$$
		v'(1)=\left( 1,2,\frac{1}{2} \right)
		$$
		- חשבו קצב שינוי הטמפרטורה שמודד טרמומטר של חללית זמן ב-$(1,1,1)$.
		**פתרון**:
		נחשב את:
		$$
		\begin{aligned}
		\frac{\mathrm{d}T}{\mathrm{d}t}=T'_{x}\cdot x'+T'_{y}\cdot y'+T'_{z}\cdot z'\end{aligned}
		$$
		מתקיים:
		$$
		\begin{aligned}
		&T'_{x}=yz=1 \\
		&T'_{y}=xz=1 \\
		&T'_{z}=xy=1
		\end{aligned}
		$$
		ולכן:
		$$
		\frac{\mathrm{d}T}{\mathrm{d}t}=1\cdot 1+1\cdot 2+1\cdot \frac{1}{2}=3 \frac{1}{2}
		$$
		- חשבו את הנגזרת המכוונת של $T$ בכיוון המסלול בנקודה $(1,1,1)$.
		**פתרון**:
		נחשב:
		$$
		\frac{ \partial T }{ \partial a } =\vec{\nabla} T\cdot  \hat{a}=(1,1,1)\cdot\frac{\left( 1,2,\frac{1}{2} \right)}{\sqrt{ 5 \frac{1}{4} }}=\frac{3 \frac{1}{2}}{\sqrt{ 5 \frac{1}{4} }}
		$$
		- מצאו והסבירו את הקשר בין סעיפים 1-3.
		**פתרון**:
		$$
		\frac{\mathrm{d}T}{\mathrm{d}s}=\frac{\frac{\mathrm{d}T}{\mathrm{d}t}}{\frac{\mathrm{d}s}{\mathrm{d}t}}=\frac{\mathrm{d}T}{\mathrm{d}s}
		$$


