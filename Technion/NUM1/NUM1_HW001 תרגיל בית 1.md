# תרגיל בית 1

|  | סטודנט א' | סטודנט ב' |
| ---- | ---- | ---- |
| **שם** | עידו פנג בנטוב | ניר קרל |
| **ת"ז** | 322869140 | 322437203 |
| **דואר אלקטרוני** | ido.fang@campus.technion.ac.il | nir.karl@campus.technion.ac.il |

## תרגיל 1
נדרג עד שנקבל מטריצה משולשת עליונה:
$$
A=\left(\begin{array}{cccc|c}
4 & -4 & -8 & -16 & -48 \\
-4 & 7 & 14 & 25  & 78\\
4 & -7 & -12 & -17 & -45\\
-4 & 7 & 12 & 18 & 49
\end{array}\right)
$$
$$
\begin{aligned}
&\xrightarrow
{\begin{matrix}
r_{2} = r_{2} + r_{1} \\
r_{3} = r_{3} - r_{1} \\
r_{4} = r_{4} + r_{1}
\end{matrix}}
\left(\begin{array}{cccc|c}
4 & -4 & -8 & -16 & -48 \\
0 & 3 & 6 & 9  & 30\\
0 & -3 & -4 & -1  & 3\\
0 & 3 & 4 & 2 & 1
\end{array}\right) \\[2ex]
&\xrightarrow
{\begin{matrix}
r_{3}=r_{3}+r_{2} \\
r_{4}=r_{4}-r_{2}
\end{matrix}}
\left(\begin{array}{cccc|c}
4 & -4 & -8 & -16  & -48\\
0 & 3 & 6 & 9  & 30\\
0 & 0 & 2 & 8  & 33\\
0 & 0 & -2 & -7 & -29
\end{array}\right) \xrightarrow{r_{4}=r_{4}-r_{3}}
\left(\begin{array}{cccc|c}
4 & -4 & -8 & -16  & -48\\
0 & 3 & 6 & 9  & 30\\
0 & 0 & 2 & 8  & 33\\
0 & 0 & 0 & 1 & 4
\end{array}\right) 
\end{aligned}
$$

נפתור עבור $x_{4}$:

$$
x_{4}=\frac{a_{45}}{a_{44}}=\frac{4}{1}=4
$$
ועבור שאר ה-$x$-ים:
$$
\begin{aligned}
x_{3}&=\dfrac{a_{35}-\sum ^{4}_{j=4}a_{3j}x_{j}}{a_{31}}=\dfrac{33-(8\cdot 4)}{2}=\frac{1}{2} \\
{x}_{2}&=\dfrac{a_{25}-\sum ^{4}_{j=4}a_{2j}x_{j}}{a_{21}}=\dfrac{30-\left( 9\cdot 4+6\cdot \frac{1}{2} \right)}{3}=-3 \\
{x}_{1}&=\dfrac{a_{15}-\sum ^{4}_{j=4}a_{1j}x_{j}}{a_{21}}=\dfrac{-48-\left( -16\cdot 4-8\cdot \frac{1}{2}-4\cdot(-3) \right)}{4}=2
\end{aligned}
$$

אכן הגענו לתשובה:
$$
\boxed {
[x_{1},\; x_{2},\; x_{3},\; x_{4}]=\left[ 2,\; -3,\; \frac{1}{2},\; 4 \right]
 }
$$

##  תרגיל 2
### סעיף א'
$$
\begin{aligned}
A&=\begin{pmatrix}
1 & -\frac{1}{3} & \frac{2}{3} \\
\frac{1}{2} & 1 & \frac{3}{2} \\
-2 & 2 & 1
\end{pmatrix} \\[2ex]
&\xrightarrow
{r_{2}=r_{2}-\frac{1}{2}r_{1} \\} 
\begin{pmatrix}
1 & -\frac{1}{3} & \frac{2}{3} \\
0 & \frac{7}{6} & \frac{7}{6} \\
-2 & 2 & 1
\end{pmatrix} \\[2ex]
&\xrightarrow{r_{3}=r_{3}+2r_{1}}
\begin{pmatrix}
1 & -\frac{1}{3} & \frac{2}{3} \\
0 & \frac{7}{6} & \frac{7}{6} \\
0 & \frac{4}{3} & \frac{7}{3}
\end{pmatrix}
 \\[2ex]
&\xrightarrow{r_{3}=r_{3}-\frac{4}{3}\cdot \frac{6}{7}r_{2}}
\begin{pmatrix}
1 & -\frac{1}{3} & \frac{2}{3} \\
0 & \frac{7}{6} & \frac{7}{6} \\
0 & 0 & 1
\end{pmatrix}
\end{aligned}
$$

### סעיף ב'
את פעולות השורה ניתן לייצג בעזרת כפל מטריצות מצד שמאל עם המטריצות הבאות:
$$
L_{1}=\begin{pmatrix}
1 & 0 & 0 \\
-\frac{1}{2} & 1 & 0 \\
0 & 0 & 1
\end{pmatrix},\; L_{2}=\begin{pmatrix}
1 & 0 & 0 \\
0 & 1 & 0 \\
2 & 0 & 1
\end{pmatrix},\; L_{3}=\begin{pmatrix}
1 & 0 & 0 \\
0 & 1 & 0 \\
0 & -\frac{8}{7} & 1
\end{pmatrix}
$$

פעולה ראשונה:
$$
A'=L_{1}A=L_{1}=\begin{pmatrix}
1 & 0 & 0 \\
-\frac{1}{2} & 1 & 0 \\
0 & 0 & 1
\end{pmatrix}\cdot \begin{pmatrix}
1 & -\frac{1}{3} & \frac{2}{3} \\
\frac{1}{2} & 1 & \frac{3}{2} \\
-2 & 2 & 1
\end{pmatrix} = \begin{pmatrix}
1 & -\frac{1}{3} & \frac{2}{3} \\
0 & \frac{7}{6} & \frac{7}{6} \\
-2 & 2 & 1
\end{pmatrix}
$$

פעולה שנייה:
$$
A''=L_{2}A'=\begin{pmatrix}
1 & 0 & 0 \\
0 & 1 & 0 \\
2 & 0 & 1
\end{pmatrix}\cdot \begin{pmatrix}
1 & -\frac{1}{3} & \frac{2}{3} \\
0 & \frac{7}{6} & \frac{7}{6} \\
-2 & 2 & 1
\end{pmatrix}=\begin{pmatrix}
1 & -\frac{1}{3} & \frac{2}{3} \\
0 & \frac{7}{6} & \frac{7}{6} \\
0 & \frac{4}{3} & \frac{7}{3}
\end{pmatrix}
$$

פעולה שלישית:
$$
U=L_{3}A''=\begin{pmatrix}
1 & 0 & 0 \\
0 & 1 & 0 \\
0 & -\frac{8}{7} & 1
\end{pmatrix}\cdot \begin{pmatrix}
1 & -\frac{1}{3} & \frac{2}{3} \\
0 & \frac{7}{6} & \frac{7}{6} \\
0 & \frac{4}{3} & \frac{7}{3}
\end{pmatrix}=\begin{pmatrix}
1 & -\frac{1}{3} & \frac{2}{3} \\
0 & \frac{7}{6} & \frac{7}{6} \\
0 & 0 & 1
\end{pmatrix}
$$

### סעיף ג'
$$
L_{1}^{-1}: \left(\begin{array}{ccc|ccc}
1 & 0 & 0  & 1 & 0 & 0\\
-\frac{1}{2} & 1 & 0  & 0 & 1 & 0\\
0 & 0 & 1 & 0 & 0 & 1
\end{array}\right)\xrightarrow{r_{2}=r_{2}+\frac{1}{2}r_{1}}
\left(\begin{array}{ccc|ccc}
1 & 0 & 0  & 1 & 0 & 0\\
0 & 1 & 0  & \frac{1}{2} & 1 & 0\\
0 & 0 & 1 & 0 & 0 & 1
\end{array}\right)
$$
$$
\boxed {
L_{1}^{-1}=\begin{pmatrix}
1 & 0 & 0 \\
\frac{1}{2} & 1 & 0 \\
0 & 0 & 1
\end{pmatrix}
 }
$$
$$
L_{2}^{-1}: \left(\begin{array}{ccc|ccc}
1 & 0 & 0  & 1 & 0 & 0\\
0 & 1 & 0  & 0 & 1 & 0\\
2 & 0 & 1 & 0 & 0 & 1
\end{array}\right)\xrightarrow{r_{3}=r_{3}-2r_{1}}
\left(\begin{array}{ccc|ccc}
1 & 0 & 0  & 1 & 0 & 0\\
0 & 1 & 0  & 0 & 1 & 0\\
0 & 0 & 1 & -2 & 0 & 1
\end{array}\right)
$$
$$
\boxed {
L_{2}^{-1}=\begin{pmatrix}
1 & 0 & 0 \\
0 & 1 & 0 \\
-2 & 0 & 1
\end{pmatrix}
 }
$$
$$
L_{3}^{-1}: \left(\begin{array}{ccc|ccc}
1 & 0 & 0  & 1 & 0 & 0\\
0 & 1 & 0  & 0 & 1 & 0\\
0 & -\frac{8}{7} & 1 & 0 & 0 & 1
\end{array}\right)\xrightarrow{r_{3}=r_{3}+\frac{8}{7}r_{2}}
\left(\begin{array}{ccc|ccc}
1 & 0 & 0  & 1 & 0 & 0\\
0 & 1 & 0  & 0 & 1 & 0\\
0 & 0 & 1 & 0 & \frac{8}{7} & 1
\end{array}\right)
$$
$$
\boxed {
L_{3}^{-1}=\begin{pmatrix}
1 & 0 & 0 \\
0 & 1 & 0 \\
0 & \frac{8}{7} & 1
\end{pmatrix}
 }
$$

### סעיף ד'

על מנת למצוא את $L$ מתוך המטריצות של פעולות השורה שמצאנו בסעיפים קודמים, נחבר את המטריצות ההופכיות להן שמצאנו בסעיף הקודם.

$$
\begin{aligned}
L&=L_{1}+L_{2}+L_{3} \\[2ex]
&=\begin{pmatrix}
1 & 0 & 0 \\
\frac{1}{2} & 1 & 0 \\
0 & 0 & 1
\end{pmatrix}+\begin{pmatrix}
1 & 0 & 0 \\
0 & 1 & 0 \\
-2 & 0 & 1
\end{pmatrix}+\begin{pmatrix}
1 & 0 & 0 \\
0 & 1 & 0 \\
0 & \frac{8}{7} & 1
\end{pmatrix}\\[2ex]
&=\begin{pmatrix}
1 & 0 & 0 \\
\frac{1}{2} & 1 & 0 \\
-2 & \frac{8}{7} & 1
\end{pmatrix}
\end{aligned}
$$

מחיבור מטריצות אלו קיבלנו מטריצה משולשית תחתונה, וכעת נראה שהכפלתה במטריצה המשולשית העליונה שקיבלנו במהלך הדירוג בשיטת גאוס נותן לנו את המטריצה המקורית.

$$
\begin{aligned}
&\begin{pmatrix}
1 & 0 & 0 \\
\frac{1}{2} & 1 & 0 \\
-2 & \frac{8}{7} & 1
\end{pmatrix}\cdot \begin{pmatrix}
1 & -\frac{1}{3} & \frac{2}{3} \\
0 & \frac{7}{6} & \frac{7}{6} \\
0 & 0 & 1
\end{pmatrix} \\[2ex]
&=\begin{pmatrix}
1+0+0 & -\frac{1}{3}+0+0 & \frac{2}{3}+0+0 \\
\frac{1}{2}+0+0 & -\frac{1}{3}\cdot \frac{1}{2}+\frac{7}{6}+0 & \frac{1}{2}\cdot \frac{2}{3}+\frac{7}{6}+0 \\
-2+0+0 & -2\cdot \left( -\frac{1}{3} \right)+\frac{8}{7}\cdot \frac{7}{6}+0 & -2\cdot \frac{2}{3}+\frac{8}{7}\cdot \frac{7}{6}+1
\end{pmatrix} \\[2ex]
&=\begin{pmatrix}
1 & -\frac{1}{3} & \frac{2}{3} \\
\frac{1}{2} & 1 & \frac{3}{2} \\
-2 & 2 & 1
\end{pmatrix}
\end{aligned}
$$

### סעיף ה'

פירוק המטריצה לפי הסעיפים הקודמים:
$$
\underbrace{\begin{pmatrix}
1 & 0 & 0 \\
\frac{1}{2} & 1 & 0 \\
-2 & \frac{8}{7} & 1
\end{pmatrix}}_{L}\cdot \underbrace{\begin{pmatrix}
1 & -\frac{1}{3} & \frac{2}{3} \\
0 & \frac{7}{6} & \frac{7}{6} \\
0 & 0 & 1
\end{pmatrix}}_{U}
$$

פירוק המטריצה לפי תרגול 2 שאלה 4:
$$
\underbrace{\begin{pmatrix}
1 & 0 & 0 \\
\frac{1}{2} & \frac{7}{6} & 0 \\
-2 & \frac{4}{3} & 1
\end{pmatrix}}_{L}\cdot \underbrace{\begin{pmatrix}
1 & -\frac{1}{3} & \frac{2}{3} \\
0 & 1 & 1 \\
0 & 0 & 1
\end{pmatrix}}_{U}
$$

קיבלנו שהפירוקים שונים, הדבר קורה כי השתמשנו באלגוריתמים שונים. פעם אחת השתמשנו באלגוריתם דוליטל, ופעם שניה ב-"crout".



## תרגיל 3
### סעיף א'
הראו כי:
$$
\ln(x-\sqrt{ x^{2}-1 })=-\ln(x+\sqrt{ x^{2}-1 })
$$
**פתרון**:
$$
\begin{aligned}
\ln(x-\sqrt{ x^{2}-1 })&=-(-\ln(x-\sqrt{ x^{2}-1 })) \\[1ex]
&=-\ln(x-\sqrt{ x^{2}-1 })^{-1} \\[1ex]
&=-\ln\left( \frac{1}{x-\sqrt{ x^{2}-1 }} \right) \\[1ex]
&=-\ln\left( \frac{x+\sqrt{ x^{2}-1 }}{(x-\sqrt{ x^{2}-1 })(x+\sqrt{ x^{2}-1 })} \right) \\[1ex]
&=-\ln\left( \frac{x+\sqrt{ x^{2}-1 }}{x^{2}-(x^{2}-1)} \right) \\[1ex]
&\overset{\checkmark }{=}-\ln(x+\sqrt{ x^{2}-1 })
\end{aligned}
$$
### סעיף ב'
איזה מצורות אלו טובה יותר לחישוב נומרי? נמקו למה, והציגו דוגמה הממחישה זאת.
**פתרון**:
אנו נעדיף את הביטוי הימני לחישוב נומרי. בביטוי השמאלי ישנו חיסור, שגורם ליותר טעויות כאשר מחסרים שני מספרים מאוד קרובים אחד לשני. למשל, עבור $x=100$, עם דיוק של 3 ספרות, ביטוי שמאל יניב לנו:
$$
\begin{aligned}
\ln(100-\sqrt{ 100^{2}-1 })&=\ln(100-\sqrt{ 9999 })=\ln(100-\sqrt{ 10000 })=\ln(0)\ \\
&=\text{undefined}
\end{aligned}
$$
ואלו ביטוי ימין:
$$
\begin{aligned}
-\ln(100+\sqrt{ 100^{2}-1 })&=\dots =-\ln(100+\sqrt{10000}) \\
&=-\ln(200) \\
&= -5.2983\dots   \\
&=-5.3
\end{aligned}
$$
### סעיף ג'
עבור אלו ערכים של $x$ ההבדל משמעותי?
**פתרון**:
ככל ש-$x$ גדול יותר, ההבדל נעשה יותר ויותר משמעותי, כי הביטוי $x-\sqrt{ x^{2}-1 }$ שואף יותר ויותר לאפס, מה שיגרום לחישוב הנומרי להגיע למסקנה הלא נכונה שאין תשובה.
![[Pasted image 20240131170548.png|book|400]]

## תרגיל 4
בשאלה זו נחקור איבוד דיוק במחשב. נתחיל עם הסדרה:
$$
\begin{cases}
{a}_{0}=\frac{1.0}{3.0}\approx 0.33333\dots \\
a_{n+1}=a_{n}\cdot 10-3
\end{cases} 
$$
שימו לב שהערך האנליטי המדויק הוא:
$$
a_{n+1}=a_{n}=\dots =a_{0}=\frac{1}{3}
$$
### סעיף א'
בצעו את האיטרציות במחשב (לפחות עד $n=30$) ושרטטו את השגיאה האבסולוטית $|a_{n}-\frac{1}{3}|$ כתלות ב-$n$.

**פתרון**:
```matlab
a = zeros(1,30);
a(1) = 1/3;
err_abs = zeros(1,30);

for n = 1:29
a(n+1)=10*a(n)-3;
err_abs(n+1) = abs(a(n+1)-1/3);
end

figure;
plot(1:30, err_abs, LineWidth=3)
figure;
semilogy(1:30, err_abs, LineWidth=3)
```

![[Technion/NUM1/NUM1_HW001/Figure_1.png|book|350]]
### סעיף ב'
איזו פונקציה מתארת את השגיאה כתלות ב-$n$? (מומלץ לצייר את השגיאה כתלות ב-$n$ על סקאלה לוגריתמית בציר $y$).
**פתרון**:
![[Technion/NUM1/NUM1_HW001/Figure_2.png|book|350]]
קיבלנו קו ישר בסקאלה לוגריתמית, מה שמעיד שהפונקציה אקספוננציאלית.

### סעיף ג'
כדי להסביר מדוע השגיאה כל פעם גדלה, ואף גדלה כל פעם פי $10$, נניח כי אנחנו מחשבים עד דיוק של $3$ ספרות, כך שכבר בהתחלה יש לנו איזושהי שגיאה $\delta$:
$$
\begin{aligned}
n=1:\quad& a_{1}=0.333 +\delta\\
n=2:\quad& {a}_2=3.33+10\delta-3=0.33+10\delta \\
n=3:\quad& a_{3}=3.3+100\delta-3=0.3+100\delta
\end{aligned}
$$
כל פעם אנו מגדילים את השגיאה פי $10$, ולכן בגרף הלוגריתמי על בסיס $10$ אנחנו מקבלים קו ישר.


## שאלה 5

### סעיף א'
ניקח מטריצה משולשית עליונה בגודל $A^{n\times n}$.
נפתח את הדטרמיננטה לפי העמודה הראשונה:
מכיוון שכל האיברים בעמודה הראשונה שאינם האיבר הראשון הם אפס, נקבל שתוצאת הדטרמיננטה היא האיבר הראשון כפול המינור שלו.
לכן קיבלנו שהמינור שלו הוא: $M^{(n-1)\times (n-1)}$ שגם הוא מטריצה משולשית עליונה.
נעשה גם לו פיתוח דטרמיננטה לפי העמודה הראשונה ומאותן סיבות כמו בפעם הראשונה נקבל את הערך שבשורה הראשונה, בעמודה הראשונה כפול המינור שלו.
נעשה את אותה הפעולה באופן רקורסיבי עד שנגיע למינור בגודל 1, שהדטרמיננטה שלו היא הערך עצמו. ונקבל שהדטרמיננטה של המטריצה $A$ היא מכפלת כל הערכים שעל האלכסון הראשי.
באופן דומה אפשר לפתח את הדטרמיננטה של מטריצה משולשית תחתונה לפי העמודה האחרונה ולקבל את אותה המסקנה.

### סעיף ב'
מכיוון שהוכחנו בסיף א. שהדטרמיננטה של מטריצה משולשית (עליונה \ תחתונה) היא מכפלת איברי האלכסון, נציב את זה לתוך הזהות הנתונה ונקבל:
$$
\det(LU)=\det (L)\cdot \det(U)=\prod_{}^{}l_{ii}\cdot \prod_{}^{}u_{ii}
$$
ולכן אם $A=LU$ הדטרמיננטה של $A$ :$$
\det(A)=\det(LU)=\prod_{}^{}l_{ii}\prod_{}^{}u_{ii}
$$

### סעיף ג'
 סיבוכיות החישוב בשיטה זו הוא $O(n)$ מכיוון שאנחנו רצים פעם אחת על איברי האלכסון במטריצה.
 הסיבוכיות של חישוב דטרמיננטה לפי הגדרה לעומת זאת היא: $O(n!)$ מכיוון שאנחנו מבצעים בשורה הראשונה $n$ מכפלות של איבר במינור שלו, ולכל מינור אנחנו מחשבים $n-1$ חישובים של איבר כפול המינור שלו וכן הלאה...